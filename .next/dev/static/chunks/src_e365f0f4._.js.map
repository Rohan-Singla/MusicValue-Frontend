{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/services/audius.ts"],"sourcesContent":["import { AUDIUS_API_KEY, AUDIUS_API_BASE } from \"@/lib/constants\";\n\nconst BASE_URL = AUDIUS_API_BASE;\n\nexport interface AudiusUser {\n  id: string;\n  name: string;\n  handle: string;\n  profile_picture: {\n    \"150x150\": string;\n    \"480x480\": string;\n    \"1000x1000\": string;\n  } | null;\n  follower_count: number;\n}\n\nexport interface AudiusTrack {\n  id: string;\n  title: string;\n  artwork: {\n    \"150x150\": string;\n    \"480x480\": string;\n    \"1000x1000\": string;\n  };\n  description: string;\n  genre: string;\n  mood: string;\n  play_count: number;\n  favorite_count: number;\n  repost_count: number;\n  duration: number;\n  user: AudiusUser;\n}\n\nasync function audiusFetch<T>(endpoint: string, params?: Record<string, string>): Promise<T> {\n  const url = new URL(`${BASE_URL}${endpoint}`);\n\n  if (params) {\n    for (const [key, value] of Object.entries(params)) {\n      if (value !== undefined && value !== \"\") {\n        url.searchParams.set(key, value);\n      }\n    }\n  }\n\n  const response = await fetch(url.toString(), {\n    headers: {\n      Authorization: `Bearer ${AUDIUS_API_KEY}`,\n      Accept: \"application/json\",\n    },\n  });\n\n  if (!response.ok) {\n    throw new Error(\n      `Audius API error: ${response.status} ${response.statusText}`\n    );\n  }\n\n  const json = await response.json();\n  return json.data as T;\n}\n\nexport async function getTrack(trackId: string): Promise<AudiusTrack> {\n  return audiusFetch<AudiusTrack>(`/tracks/${trackId}`);\n}\n\nexport async function getTrendingTracks(\n  limit?: number,\n  genre?: string,\n  time?: \"week\" | \"month\" | \"allTime\"\n): Promise<AudiusTrack[]> {\n  const params: Record<string, string> = {};\n\n  if (limit !== undefined) {\n    params.limit = String(limit);\n  }\n  if (genre) {\n    params.genre = genre;\n  }\n  if (time) {\n    params.time = time;\n  }\n\n  return audiusFetch<AudiusTrack[]>(\"/tracks/trending\", params);\n}\n\nexport async function searchTracks(\n  query: string,\n  limit?: number\n): Promise<AudiusTrack[]> {\n  const params: Record<string, string> = { query };\n\n  if (limit !== undefined) {\n    params.limit = String(limit);\n  }\n\n  return audiusFetch<AudiusTrack[]>(\"/tracks/search\", params);\n}\n\nexport async function getUserTracks(userId: string): Promise<AudiusTrack[]> {\n  return audiusFetch<AudiusTrack[]>(`/users/${userId}/tracks`, { limit: \"100\" });\n}\n\n/** Get the direct stream URL for a track */\nexport function getTrackStreamUrl(trackId: string): string {\n  const url = new URL(`${BASE_URL}/tracks/${trackId}/stream`);\n  if (AUDIUS_API_KEY) {\n    url.searchParams.set(\"api_key\", AUDIUS_API_KEY);\n  }\n  return url.toString();\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAEA,MAAM,WAAW,6IAAe;AAgChC,eAAe,YAAe,QAAgB,EAAE,MAA+B;IAC7E,MAAM,MAAM,IAAI,IAAI,GAAG,WAAW,UAAU;IAE5C,IAAI,QAAQ;QACV,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,OAAO,OAAO,CAAC,QAAS;YACjD,IAAI,UAAU,aAAa,UAAU,IAAI;gBACvC,IAAI,YAAY,CAAC,GAAG,CAAC,KAAK;YAC5B;QACF;IACF;IAEA,MAAM,WAAW,MAAM,MAAM,IAAI,QAAQ,IAAI;QAC3C,SAAS;YACP,eAAe,CAAC,OAAO,EAAE,4IAAc,EAAE;YACzC,QAAQ;QACV;IACF;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MACR,CAAC,kBAAkB,EAAE,SAAS,MAAM,CAAC,CAAC,EAAE,SAAS,UAAU,EAAE;IAEjE;IAEA,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,OAAO,KAAK,IAAI;AAClB;AAEO,eAAe,SAAS,OAAe;IAC5C,OAAO,YAAyB,CAAC,QAAQ,EAAE,SAAS;AACtD;AAEO,eAAe,kBACpB,KAAc,EACd,KAAc,EACd,IAAmC;IAEnC,MAAM,SAAiC,CAAC;IAExC,IAAI,UAAU,WAAW;QACvB,OAAO,KAAK,GAAG,OAAO;IACxB;IACA,IAAI,OAAO;QACT,OAAO,KAAK,GAAG;IACjB;IACA,IAAI,MAAM;QACR,OAAO,IAAI,GAAG;IAChB;IAEA,OAAO,YAA2B,oBAAoB;AACxD;AAEO,eAAe,aACpB,KAAa,EACb,KAAc;IAEd,MAAM,SAAiC;QAAE;IAAM;IAE/C,IAAI,UAAU,WAAW;QACvB,OAAO,KAAK,GAAG,OAAO;IACxB;IAEA,OAAO,YAA2B,kBAAkB;AACtD;AAEO,eAAe,cAAc,MAAc;IAChD,OAAO,YAA2B,CAAC,OAAO,EAAE,OAAO,OAAO,CAAC,EAAE;QAAE,OAAO;IAAM;AAC9E;AAGO,SAAS,kBAAkB,OAAe;IAC/C,MAAM,MAAM,IAAI,IAAI,GAAG,SAAS,QAAQ,EAAE,QAAQ,OAAO,CAAC;IAC1D,IAAI,4IAAc,EAAE;QAClB,IAAI,YAAY,CAAC,GAAG,CAAC,WAAW,4IAAc;IAChD;IACA,OAAO,IAAI,QAAQ;AACrB"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/hooks/useAudius.ts"],"sourcesContent":["\"use client\";\n\nimport { useQuery } from \"@tanstack/react-query\";\nimport {\n  getTrack,\n  getTrendingTracks,\n  searchTracks,\n} from \"@/services/audius\";\n\nexport function useTrack(trackId: string | undefined) {\n  return useQuery({\n    queryKey: [\"audius\", \"track\", trackId],\n    queryFn: () => getTrack(trackId!),\n    enabled: trackId !== undefined,\n  });\n}\n\nexport function useTrendingTracks(limit?: number) {\n  return useQuery({\n    queryKey: [\"audius\", \"trending\", limit],\n    queryFn: () => getTrendingTracks(limit),\n  });\n}\n\nexport function useSearchTracks(query: string) {\n  return useQuery({\n    queryKey: [\"audius\", \"search\", query],\n    queryFn: () => searchTracks(query),\n    enabled: query.length > 2,\n  });\n}\n"],"names":[],"mappings":";;;;;;;;AAEA;AACA;;AAHA;;;AASO,SAAS,SAAS,OAA2B;;IAClD,OAAO,IAAA,2RAAQ,EAAC;QACd,UAAU;YAAC;YAAU;YAAS;SAAQ;QACtC,OAAO;iCAAE,IAAM,IAAA,wIAAQ,EAAC;;QACxB,SAAS,YAAY;IACvB;AACF;GANgB;;QACP,2RAAQ;;;AAOV,SAAS,kBAAkB,KAAc;;IAC9C,OAAO,IAAA,2RAAQ,EAAC;QACd,UAAU;YAAC;YAAU;YAAY;SAAM;QACvC,OAAO;0CAAE,IAAM,IAAA,iJAAiB,EAAC;;IACnC;AACF;IALgB;;QACP,2RAAQ;;;AAMV,SAAS,gBAAgB,KAAa;;IAC3C,OAAO,IAAA,2RAAQ,EAAC;QACd,UAAU;YAAC;YAAU;YAAU;SAAM;QACrC,OAAO;wCAAE,IAAM,IAAA,4IAAY,EAAC;;QAC5B,SAAS,MAAM,MAAM,GAAG;IAC1B;AACF;IANgB;;QACP,2RAAQ"}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/lib/idl.json"],"sourcesContent":["{\"address\":\"Atf26b8XuQ49cmvfTsvU5PjZ56zhoCvFiGQ7bBW2zoio\",\"metadata\":{\"name\":\"music_value\",\"version\":\"0.1.0\",\"spec\":\"0.1.0\",\"description\":\"MusicValue - Fans back music tracks and earn yield\"},\"instructions\":[{\"name\":\"deposit\",\"discriminator\":[242,35,198,137,82,225,242,182],\"accounts\":[{\"name\":\"user\",\"writable\":true,\"signer\":true},{\"name\":\"vault\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116]},{\"kind\":\"account\",\"path\":\"vault.audius_track_id\",\"account\":\"TrackVault\"}]}},{\"name\":\"user_position\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[112,111,115,105,116,105,111,110]},{\"kind\":\"account\",\"path\":\"vault\"},{\"kind\":\"account\",\"path\":\"user\"}]}},{\"name\":\"user_usdc\",\"writable\":true},{\"name\":\"vault_token_account\",\"writable\":true},{\"name\":\"share_mint\",\"writable\":true},{\"name\":\"user_shares\",\"writable\":true},{\"name\":\"token_program\",\"address\":\"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA\"},{\"name\":\"system_program\",\"address\":\"11111111111111111111111111111111\"}],\"args\":[{\"name\":\"amount\",\"type\":\"u64\"}]},{\"name\":\"distribute_yield\",\"discriminator\":[233,92,186,157,235,238,212,114],\"accounts\":[{\"name\":\"authority\",\"writable\":true,\"signer\":true},{\"name\":\"vault\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116]},{\"kind\":\"account\",\"path\":\"vault.audius_track_id\",\"account\":\"TrackVault\"}]}},{\"name\":\"authority_usdc\",\"writable\":true},{\"name\":\"vault_token_account\",\"writable\":true},{\"name\":\"token_program\",\"address\":\"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA\"}],\"args\":[{\"name\":\"amount\",\"type\":\"u64\"}]},{\"name\":\"initialize_vault\",\"discriminator\":[48,191,163,44,71,129,63,164],\"accounts\":[{\"name\":\"authority\",\"writable\":true,\"signer\":true},{\"name\":\"vault\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116]},{\"kind\":\"arg\",\"path\":\"audius_track_id\"}]}},{\"name\":\"usdc_mint\"},{\"name\":\"vault_token_account\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116,95,116,111,107,101,110]},{\"kind\":\"account\",\"path\":\"vault\"}]}},{\"name\":\"share_mint\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[115,104,97,114,101,95,109,105,110,116]},{\"kind\":\"account\",\"path\":\"vault\"}]}},{\"name\":\"token_program\",\"address\":\"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA\"},{\"name\":\"system_program\",\"address\":\"11111111111111111111111111111111\"},{\"name\":\"rent\",\"address\":\"SysvarRent111111111111111111111111111111111\"}],\"args\":[{\"name\":\"audius_track_id\",\"type\":\"string\"},{\"name\":\"cap\",\"type\":\"u64\"},{\"name\":\"royalty_pct\",\"type\":\"u8\"},{\"name\":\"distribution_interval\",\"type\":\"u8\"},{\"name\":\"vault_duration_months\",\"type\":\"u16\"},{\"name\":\"pledge_note\",\"type\":\"string\"}]},{\"name\":\"update_pledge\",\"discriminator\":[45,167,165,215,223,29,200,170],\"accounts\":[{\"name\":\"authority\",\"writable\":true,\"signer\":true},{\"name\":\"vault\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116]},{\"kind\":\"account\",\"path\":\"vault.audius_track_id\",\"account\":\"TrackVault\"}]}}],\"args\":[{\"name\":\"royalty_pct\",\"type\":\"u8\"},{\"name\":\"distribution_interval\",\"type\":\"u8\"},{\"name\":\"vault_duration_months\",\"type\":\"u16\"},{\"name\":\"pledge_note\",\"type\":\"string\"}]},{\"name\":\"withdraw\",\"discriminator\":[183,18,70,156,148,109,161,34],\"accounts\":[{\"name\":\"user\",\"writable\":true,\"signer\":true},{\"name\":\"vault\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116]},{\"kind\":\"account\",\"path\":\"vault.audius_track_id\",\"account\":\"TrackVault\"}]}},{\"name\":\"user_position\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[112,111,115,105,116,105,111,110]},{\"kind\":\"account\",\"path\":\"vault\"},{\"kind\":\"account\",\"path\":\"user\"}]}},{\"name\":\"vault_token_account\",\"writable\":true},{\"name\":\"user_usdc\",\"writable\":true},{\"name\":\"share_mint\",\"writable\":true},{\"name\":\"user_shares\",\"writable\":true},{\"name\":\"token_program\",\"address\":\"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA\"}],\"args\":[{\"name\":\"shares\",\"type\":\"u64\"}]}],\"accounts\":[{\"name\":\"TrackVault\",\"discriminator\":[106,106,191,101,238,81,75,254]},{\"name\":\"UserPosition\",\"discriminator\":[251,248,209,245,83,234,17,27]}],\"errors\":[{\"code\":6000,\"name\":\"VaultCapExceeded\",\"msg\":\"Vault has reached its funding cap\"},{\"code\":6001,\"name\":\"ZeroDeposit\",\"msg\":\"Deposit amount must be greater than zero\"},{\"code\":6002,\"name\":\"InsufficientShares\",\"msg\":\"Insufficient shares to withdraw\"},{\"code\":6003,\"name\":\"ZeroWithdraw\",\"msg\":\"Withdraw amount must be greater than zero\"},{\"code\":6004,\"name\":\"TrackIdTooLong\",\"msg\":\"Audius track ID is too long (max 32 characters)\"},{\"code\":6005,\"name\":\"InvalidCap\",\"msg\":\"Vault cap must be greater than zero\"},{\"code\":6006,\"name\":\"Unauthorized\",\"msg\":\"Only the vault authority can perform this action\"},{\"code\":6007,\"name\":\"NoShareholders\",\"msg\":\"Cannot distribute yield when there are no shareholders\"},{\"code\":6008,\"name\":\"InvalidRoyaltyPct\",\"msg\":\"Royalty percentage must be between 0 and 100\"},{\"code\":6009,\"name\":\"InvalidDistributionInterval\",\"msg\":\"Distribution interval must be 0 (monthly), 1 (quarterly), or 2 (milestone)\"},{\"code\":6010,\"name\":\"PledgeNoteTooLong\",\"msg\":\"Pledge note is too long (max 200 characters)\"}],\"types\":[{\"name\":\"TrackVault\",\"type\":{\"kind\":\"struct\",\"fields\":[{\"name\":\"authority\",\"type\":\"pubkey\"},{\"name\":\"audius_track_id\",\"type\":\"string\"},{\"name\":\"usdc_mint\",\"type\":\"pubkey\"},{\"name\":\"vault_token_account\",\"type\":\"pubkey\"},{\"name\":\"share_mint\",\"type\":\"pubkey\"},{\"name\":\"total_deposited\",\"type\":\"u64\"},{\"name\":\"cap\",\"type\":\"u64\"},{\"name\":\"total_shares\",\"type\":\"u64\"},{\"name\":\"created_at\",\"type\":\"i64\"},{\"name\":\"bump\",\"type\":\"u8\"},{\"name\":\"royalty_pct\",\"type\":\"u8\"},{\"name\":\"distribution_interval\",\"type\":\"u8\"},{\"name\":\"vault_duration_months\",\"type\":\"u16\"},{\"name\":\"pledge_note\",\"type\":\"string\"},{\"name\":\"total_yield_distributed\",\"type\":\"u64\"}]}},{\"name\":\"UserPosition\",\"type\":{\"kind\":\"struct\",\"fields\":[{\"name\":\"owner\",\"type\":\"pubkey\"},{\"name\":\"vault\",\"type\":\"pubkey\"},{\"name\":\"shares_held\",\"type\":\"u64\"},{\"name\":\"total_deposited\",\"type\":\"u64\"},{\"name\":\"deposited_at\",\"type\":\"i64\"},{\"name\":\"bump\",\"type\":\"u8\"}]}}]}"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 160, "column": 6027}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 164, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/hooks/useVault.ts"],"sourcesContent":["\"use client\";\n\nimport { useMemo } from \"react\";\nimport { useConnection, useWallet } from \"@solana/wallet-adapter-react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { PublicKey, SystemProgram, SYSVAR_RENT_PUBKEY } from \"@solana/web3.js\";\nimport {\n  getAssociatedTokenAddress,\n  TOKEN_PROGRAM_ID,\n  createAssociatedTokenAccountInstruction,\n  getAccount,\n} from \"@solana/spl-token\";\nimport { Program, AnchorProvider, BN } from \"@coral-xyz/anchor\";\nimport { PROGRAM_ID_STR, USDC_MINT_STR } from \"@/lib/constants\";\nimport { getTrack, AudiusTrack } from \"@/services/audius\";\n\nimport idl from \"@/lib/idl.json\";\n\nfunction programId() {\n  return new PublicKey(PROGRAM_ID_STR);\n}\n\nfunction usdcMint() {\n  return new PublicKey(USDC_MINT_STR);\n}\n\nfunction useProgram() {\n  const { connection } = useConnection();\n  const wallet = useWallet();\n\n  return useMemo(() => {\n    if (!wallet.publicKey || !wallet.signTransaction) return null;\n\n    try {\n      const freshPublicKey = new PublicKey(wallet.publicKey.toBytes());\n\n      const wrappedWallet = {\n        publicKey: freshPublicKey,\n        signTransaction: wallet.signTransaction,\n        signAllTransactions: wallet.signAllTransactions,\n      };\n\n      const provider = new AnchorProvider(\n        connection,\n        wrappedWallet as any,\n        AnchorProvider.defaultOptions()\n      );\n\n      // Anchor 0.30+ new IDL format: Program constructor reads address from IDL\n      return new Program(idl as any, provider);\n    } catch (e) {\n      console.warn(\"Failed to initialize Anchor program:\", e);\n      return null;\n    }\n  }, [connection, wallet]);\n}\n\nfunction getVaultPda(trackId: string) {\n  return PublicKey.findProgramAddressSync(\n    [Buffer.from(\"vault\"), Buffer.from(trackId)],\n    programId()\n  );\n}\n\nfunction getVaultTokenPda(vaultPda: PublicKey) {\n  return PublicKey.findProgramAddressSync(\n    [Buffer.from(\"vault_token\"), vaultPda.toBuffer()],\n    programId()\n  );\n}\n\nfunction getShareMintPda(vaultPda: PublicKey) {\n  return PublicKey.findProgramAddressSync(\n    [Buffer.from(\"share_mint\"), vaultPda.toBuffer()],\n    programId()\n  );\n}\n\nfunction getUserPositionPda(vaultPda: PublicKey, user: PublicKey) {\n  return PublicKey.findProgramAddressSync(\n    [Buffer.from(\"position\"), vaultPda.toBuffer(), user.toBuffer()],\n    programId()\n  );\n}\n\n/** Fetch vault state for a track */\nexport function useVault(trackId: string | undefined) {\n  const program = useProgram();\n\n  return useQuery({\n    queryKey: [\"vault\", trackId],\n    queryFn: async () => {\n      if (!program || !trackId) return null;\n      const [vaultPda] = getVaultPda(trackId);\n      try {\n        const vault = await (program.account as any).trackVault.fetch(vaultPda);\n        return {\n          address: vaultPda,\n          audiusTrackId: vault.audiusTrackId as string,\n          totalDeposited: (vault.totalDeposited as BN).toNumber(),\n          cap: (vault.cap as BN).toNumber(),\n          totalShares: (vault.totalShares as BN).toNumber(),\n          authority: vault.authority as PublicKey,\n          shareMint: vault.shareMint as PublicKey,\n          royaltyPct: (vault.royaltyPct as number) ?? 0,\n          distributionInterval: (vault.distributionInterval as number) ?? 0,\n          vaultDurationMonths: (vault.vaultDurationMonths as number) ?? 0,\n          pledgeNote: (vault.pledgeNote as string) ?? \"\",\n          totalYieldDistributed: (vault.totalYieldDistributed as BN).toNumber(),\n        };\n      } catch {\n        return null;\n      }\n    },\n    enabled: !!program && !!trackId,\n  });\n}\n\n/** Fetch user's position in a vault */\nexport function useUserPosition(trackId: string | undefined) {\n  const program = useProgram();\n  const { publicKey } = useWallet();\n\n  return useQuery({\n    queryKey: [\"position\", trackId, publicKey?.toBase58()],\n    queryFn: async () => {\n      if (!program || !trackId || !publicKey) return null;\n      const [vaultPda] = getVaultPda(trackId);\n      const [positionPda] = getUserPositionPda(vaultPda, publicKey);\n      try {\n        const position = await (program.account as any).userPosition.fetch(\n          positionPda\n        );\n        return {\n          sharesHeld: (position.sharesHeld as BN).toNumber(),\n          totalDeposited: (position.totalDeposited as BN).toNumber(),\n          depositedAt: (position.depositedAt as BN).toNumber(),\n        };\n      } catch {\n        return null;\n      }\n    },\n    enabled: !!program && !!trackId && !!publicKey,\n  });\n}\n\nexport interface InitializeVaultParams {\n  cap: number;\n  royaltyPct: number;\n  distributionInterval: number; // 0=monthly, 1=quarterly, 2=milestone\n  vaultDurationMonths: number;  // 0 = ongoing\n  pledgeNote: string;\n}\n\n/** Initialize a vault for a track with a royalty pledge */\nexport function useInitializeVault(trackId: string) {\n  const program = useProgram();\n  const { publicKey } = useWallet();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (params: InitializeVaultParams) => {\n      if (!program || !publicKey) throw new Error(\"Wallet not connected\");\n\n      const mint = usdcMint();\n      const [vaultPda] = getVaultPda(trackId);\n      const [vaultTokenAccount] = getVaultTokenPda(vaultPda);\n      const [shareMint] = getShareMintPda(vaultPda);\n\n      const tx = await (program.methods as any)\n        .initializeVault(\n          trackId,\n          new BN(params.cap),\n          params.royaltyPct,\n          params.distributionInterval,\n          params.vaultDurationMonths,\n          params.pledgeNote\n        )\n        .accounts({\n          authority: publicKey,\n          vault: vaultPda,\n          usdcMint: mint,\n          vaultTokenAccount,\n          shareMint,\n          tokenProgram: TOKEN_PROGRAM_ID,\n          systemProgram: SystemProgram.programId,\n          rent: SYSVAR_RENT_PUBKEY,\n        })\n        .rpc();\n\n      return tx;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"vault\", trackId] });\n    },\n  });\n}\n\n/** Deposit USDC into a track vault */\nexport function useDeposit(trackId: string) {\n  const program = useProgram();\n  const { publicKey } = useWallet();\n  const { connection } = useConnection();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (amount: number) => {\n      if (!program || !publicKey) throw new Error(\"Wallet not connected\");\n\n      const mint = usdcMint();\n      const [vaultPda] = getVaultPda(trackId);\n      const [vaultTokenAccount] = getVaultTokenPda(vaultPda);\n      const [shareMint] = getShareMintPda(vaultPda);\n      const [userPosition] = getUserPositionPda(vaultPda, publicKey);\n\n      const userUsdc = await getAssociatedTokenAddress(mint, publicKey);\n      const userShares = await getAssociatedTokenAddress(shareMint, publicKey);\n\n      // Check if user share account exists, if not create it\n      let preIx: any[] = [];\n      try {\n        await getAccount(connection, userShares);\n      } catch {\n        preIx.push(\n          createAssociatedTokenAccountInstruction(\n            publicKey,\n            userShares,\n            publicKey,\n            shareMint\n          )\n        );\n      }\n\n      const builder = (program.methods as any)\n        .deposit(new BN(amount))\n        .accounts({\n          user: publicKey,\n          vault: vaultPda,\n          userPosition,\n          userUsdc,\n          vaultTokenAccount,\n          shareMint,\n          userShares,\n          tokenProgram: TOKEN_PROGRAM_ID,\n          systemProgram: SystemProgram.programId,\n        });\n\n      if (preIx.length > 0) {\n        builder.preInstructions(preIx);\n      }\n\n      return await builder.rpc();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"vault\", trackId] });\n      queryClient.invalidateQueries({ queryKey: [\"position\", trackId] });\n    },\n  });\n}\n\n/** Distribute yield into the vault (artist/authority only) */\nexport function useDistributeYield(trackId: string) {\n  const program = useProgram();\n  const { publicKey } = useWallet();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (amountUsdc: number) => {\n      if (!program || !publicKey) throw new Error(\"Wallet not connected\");\n\n      const mint = usdcMint();\n      const [vaultPda] = getVaultPda(trackId);\n      const [vaultTokenAccount] = getVaultTokenPda(vaultPda);\n      const authorityUsdc = await getAssociatedTokenAddress(mint, publicKey);\n\n      const tx = await (program.methods as any)\n        .distributeYield(new BN(amountUsdc))\n        .accounts({\n          authority: publicKey,\n          vault: vaultPda,\n          authorityUsdc,\n          vaultTokenAccount,\n          tokenProgram: TOKEN_PROGRAM_ID,\n        })\n        .rpc();\n\n      return tx;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"vault\", trackId] });\n    },\n  });\n}\n\n/** Read-only program (no wallet needed — for fetching all vault accounts on the homepage) */\nfunction useReadonlyProgram() {\n  const { connection } = useConnection();\n  return useMemo(() => {\n    try {\n      const dummy = {\n        publicKey: new PublicKey(\"11111111111111111111111111111111\"),\n        signTransaction: async (tx: any) => tx,\n        signAllTransactions: async (txs: any[]) => txs,\n      };\n      const provider = new AnchorProvider(connection, dummy as any, AnchorProvider.defaultOptions());\n      return new Program(idl as any, provider);\n    } catch {\n      return null;\n    }\n  }, [connection]);\n}\n\nexport interface VaultInfo {\n  address: PublicKey;\n  audiusTrackId: string;\n  totalDeposited: number;\n  cap: number;\n  totalShares: number;\n  authority: PublicKey;\n  shareMint: PublicKey;\n  // Royalty pledge fields\n  royaltyPct: number;\n  distributionInterval: number; // 0=monthly, 1=quarterly, 2=milestone\n  vaultDurationMonths: number;  // 0 = ongoing\n  pledgeNote: string;\n  totalYieldDistributed: number;\n}\n\nexport interface VaultedTrack {\n  vault: VaultInfo;\n  track: AudiusTrack;\n}\n\n/** Fetch every TrackVault account on-chain (works without a connected wallet) */\nexport function useAllVaults() {\n  const program = useReadonlyProgram();\n\n  return useQuery({\n    queryKey: [\"all-vaults\"],\n    queryFn: async (): Promise<VaultInfo[]> => {\n      if (!program) return [];\n      const accounts = await (program.account as any).trackVault.all();\n      return accounts.map((a: any) => ({\n        address: a.publicKey as PublicKey,\n        audiusTrackId: a.account.audiusTrackId as string,\n        totalDeposited: (a.account.totalDeposited as BN).toNumber(),\n        cap: (a.account.cap as BN).toNumber(),\n        totalShares: (a.account.totalShares as BN).toNumber(),\n        authority: a.account.authority as PublicKey,\n        shareMint: a.account.shareMint as PublicKey,\n        royaltyPct: (a.account.royaltyPct as number) ?? 0,\n        distributionInterval: (a.account.distributionInterval as number) ?? 0,\n        vaultDurationMonths: (a.account.vaultDurationMonths as number) ?? 0,\n        pledgeNote: (a.account.pledgeNote as string) ?? \"\",\n        totalYieldDistributed: (a.account.totalYieldDistributed as BN).toNumber(),\n      }));\n    },\n    enabled: !!program,\n    staleTime: 30_000,\n  });\n}\n\n/** Fetch all vaults and hydrate each with Audius track metadata */\nexport function useVaultedTracks() {\n  const { data: vaults } = useAllVaults();\n\n  return useQuery({\n    queryKey: [\"vaulted-tracks\", vaults?.map((v) => v.audiusTrackId).join(\",\")],\n    queryFn: async (): Promise<VaultedTrack[]> => {\n      if (!vaults || vaults.length === 0) return [];\n      const results = await Promise.allSettled(vaults.map((v) => getTrack(v.audiusTrackId)));\n      return vaults\n        .map((vault, i) => {\n          const r = results[i];\n          return r.status === \"fulfilled\" ? { vault, track: r.value } : null;\n        })\n        .filter(Boolean) as VaultedTrack[];\n    },\n    enabled: Array.isArray(vaults),\n    staleTime: 60_000,\n  });\n}\n\n/** Withdraw from a track vault */\nexport function useWithdraw(trackId: string) {\n  const program = useProgram();\n  const { publicKey } = useWallet();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (shares: number) => {\n      if (!program || !publicKey) throw new Error(\"Wallet not connected\");\n\n      const mint = usdcMint();\n      const [vaultPda] = getVaultPda(trackId);\n      const [vaultTokenAccount] = getVaultTokenPda(vaultPda);\n      const [shareMint] = getShareMintPda(vaultPda);\n      const [userPosition] = getUserPositionPda(vaultPda, publicKey);\n\n      const userUsdc = await getAssociatedTokenAddress(mint, publicKey);\n      const userShares = await getAssociatedTokenAddress(shareMint, publicKey);\n\n      const tx = await (program.methods as any)\n        .withdraw(new BN(shares))\n        .accounts({\n          user: publicKey,\n          vault: vaultPda,\n          userPosition,\n          vaultTokenAccount,\n          userUsdc,\n          shareMint,\n          userShares,\n          tokenProgram: TOKEN_PROGRAM_ID,\n        })\n        .rpc();\n\n      return tx;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"vault\", trackId] });\n      queryClient.invalidateQueries({ queryKey: [\"position\", trackId] });\n    },\n  });\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 678, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/hooks/useAudiusAuth.ts"],"sourcesContent":["\"use client\";\n\nimport { useContext } from \"react\";\nimport { AudiusAuthContext } from \"@/providers/AudiusAuthProvider\";\n\nexport function useAudiusAuth() {\n  const ctx = useContext(AudiusAuthContext);\n  if (!ctx) {\n    throw new Error(\"useAudiusAuth must be used inside AudiusAuthProvider\");\n  }\n  return ctx;\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AAKO,SAAS;;IACd,MAAM,MAAM,IAAA,4UAAU,EAAC,+JAAiB;IACxC,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;GANgB"}},
    {"offset": {"line": 704, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/services/blinks.ts"],"sourcesContent":["import { APP_URL } from \"@/lib/constants\";\n\n/**\n * Blinks Service\n *\n * Generates Solana Action-compatible URLs and shareable Blink links\n * for the \"Back this track\" action. Uses the standard Solana Actions spec.\n *\n * Integration: OrbitFlare as RPC provider, @solana/actions for spec compliance.\n */\n\n/** Generate the Action API URL for a track */\nexport function getActionUrl(trackId: string): string {\n  return `${APP_URL}/api/actions/back-track?trackId=${encodeURIComponent(trackId)}`;\n}\n\n/** Generate a shareable Blink URL using dial.to */\nexport function getBlinkUrl(trackId: string): string {\n  const actionUrl = getActionUrl(trackId);\n  return `https://dial.to/?action=${encodeURIComponent(`solana-action:${actionUrl}`)}`;\n}\n\n/** Generate the solana-action: protocol URL */\nexport function getSolanaActionUrl(trackId: string): string {\n  return `solana-action:${getActionUrl(trackId)}`;\n}\n\n/** Copy a blink URL to clipboard and return success */\nexport async function copyBlinkToClipboard(trackId: string): Promise<boolean> {\n  try {\n    const url = getBlinkUrl(trackId);\n    await navigator.clipboard.writeText(url);\n    return true;\n  } catch {\n    return false;\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAYO,SAAS,aAAa,OAAe;IAC1C,OAAO,GAAG,qIAAO,CAAC,gCAAgC,EAAE,mBAAmB,UAAU;AACnF;AAGO,SAAS,YAAY,OAAe;IACzC,MAAM,YAAY,aAAa;IAC/B,OAAO,CAAC,wBAAwB,EAAE,mBAAmB,CAAC,cAAc,EAAE,WAAW,GAAG;AACtF;AAGO,SAAS,mBAAmB,OAAe;IAChD,OAAO,CAAC,cAAc,EAAE,aAAa,UAAU;AACjD;AAGO,eAAe,qBAAqB,OAAe;IACxD,IAAI;QACF,MAAM,MAAM,YAAY;QACxB,MAAM,UAAU,SAAS,CAAC,SAAS,CAAC;QACpC,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 742, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/components/track/VaultPanel.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useConnection, useWallet } from \"@solana/wallet-adapter-react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { PublicKey } from \"@solana/web3.js\";\nimport { getAssociatedTokenAddress, getAccount } from \"@solana/spl-token\";\nimport {\n  ArrowDownToLine,\n  ArrowUpFromLine,\n  Share2,\n  TrendingUp,\n  Loader2,\n  ExternalLink,\n  Wallet,\n  Music,\n  Lock,\n  Zap,\n} from \"lucide-react\";\nimport { useVault, useUserPosition, useDeposit, useWithdraw } from \"@/hooks/useVault\";\nimport { useAudiusAuth } from \"@/hooks/useAudiusAuth\";\nimport { copyBlinkToClipboard } from \"@/services/blinks\";\nimport toast from \"react-hot-toast\";\nimport { USDC_DECIMALS, USDC_MINT_STR } from \"@/lib/constants\";\nimport Link from \"next/link\";\n\ninterface VaultPanelProps {\n  trackId: string;\n  trackTitle: string;\n  artistUserId?: string;\n}\n\nfunction formatUSDC(amount: number): string {\n  return `$${(amount / 10 ** USDC_DECIMALS).toLocaleString(\"en-US\", {\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  })}`;\n}\n\nfunction formatPct(n: number): string {\n  return `${n.toFixed(2)}%`;\n}\n\nfunction explorerUrl(txHash: string): string {\n  return `https://explorer.solana.com/tx/${txHash}?cluster=devnet`;\n}\n\nfunction useUsdcBalance() {\n  const { connection } = useConnection();\n  const { publicKey } = useWallet();\n\n  return useQuery({\n    queryKey: [\"usdc-balance\", publicKey?.toBase58()],\n    queryFn: async () => {\n      if (!publicKey) return null;\n      try {\n        const mint = new PublicKey(USDC_MINT_STR);\n        const ata = await getAssociatedTokenAddress(mint, publicKey);\n        const account = await getAccount(connection, ata);\n        return Number(account.amount);\n      } catch {\n        return 0;\n      }\n    },\n    enabled: !!publicKey,\n    refetchInterval: 15_000,\n  });\n}\n\nexport function VaultPanel({ trackId, trackTitle, artistUserId }: VaultPanelProps) {\n  const { publicKey } = useWallet();\n  const { user: audiusUser } = useAudiusAuth();\n  const isArtist = !!(audiusUser && artistUserId && audiusUser.userId === artistUserId);\n  const { data: vault, isLoading: vaultLoading } = useVault(trackId);\n  const { data: position } = useUserPosition(trackId);\n  const deposit = useDeposit(trackId);\n  const withdraw = useWithdraw(trackId);\n  const { data: usdcBalance } = useUsdcBalance();\n\n  const [depositAmount, setDepositAmount] = useState(\"\");\n  const [withdrawAmount, setWithdrawAmount] = useState(\"\");\n  const [lastTxHash, setLastTxHash] = useState<string | null>(null);\n  const [activeTab, setActiveTab] = useState<\"deposit\" | \"withdraw\">(\"deposit\");\n\n  // ── Vault-level metrics ───────────────────────────────────────────────────\n  const progress = vault ? Math.min((vault.totalDeposited / vault.cap) * 100, 100) : 0;\n  const isCapReached = progress >= 100;\n\n  // Since deposits are always 1:1 (1 USDC lamport = 1 share token),\n  // total_shares == total principal ever deposited.\n  // Any excess in total_deposited over total_shares is pure distributed yield.\n  const totalYieldDistributed = vault\n    ? Math.max(0, vault.totalDeposited - vault.totalShares)\n    : 0;\n\n  const sharePrice =\n    vault && vault.totalShares > 0\n      ? vault.totalDeposited / vault.totalShares\n      : 1;\n\n  // ── User position metrics ─────────────────────────────────────────────────\n  const currentPositionValue =\n    position && vault && vault.totalShares > 0\n      ? (position.sharesHeld / vault.totalShares) * vault.totalDeposited\n      : 0;\n\n  const yieldEarned = position\n    ? Math.max(0, currentPositionValue - position.totalDeposited)\n    : 0;\n\n  // Real APY: annualised return since first deposit\n  const daysHeld =\n    position && position.depositedAt > 0\n      ? Math.max(1, (Date.now() / 1000 - position.depositedAt) / 86400)\n      : 0;\n\n  const realApy =\n    yieldEarned > 0 && position && position.totalDeposited > 0 && daysHeld > 0\n      ? (yieldEarned / position.totalDeposited) * (365 / daysHeld) * 100\n      : null;\n\n  // ── Handlers ─────────────────────────────────────────────────────────────\n  const balanceUSDC = usdcBalance != null ? usdcBalance / 10 ** USDC_DECIMALS : null;\n\n  const handleDeposit = async () => {\n    const amount = parseFloat(depositAmount);\n    if (!amount || amount <= 0) { toast.error(\"Enter a valid amount\"); return; }\n    if (balanceUSDC != null && amount > balanceUSDC) {\n      toast.error(`Insufficient USDC. You have $${balanceUSDC.toFixed(2)}`);\n      return;\n    }\n    try {\n      const lamports = Math.floor(amount * 10 ** USDC_DECIMALS);\n      const txHash = await deposit.mutateAsync(lamports);\n      setDepositAmount(\"\");\n      setLastTxHash(txHash);\n      toast.success(`Backed ${trackTitle} with $${amount} USDC`);\n    } catch (err: any) {\n      toast.error(err.message || \"Deposit failed\");\n    }\n  };\n\n  const handleWithdraw = async () => {\n    const amount = parseFloat(withdrawAmount);\n    if (!amount || amount <= 0) { toast.error(\"Enter a valid amount\"); return; }\n    try {\n      const shares = Math.floor(amount * 10 ** USDC_DECIMALS);\n      const txHash = await withdraw.mutateAsync(shares);\n      setWithdrawAmount(\"\");\n      setLastTxHash(txHash);\n      toast.success(`Withdrew from ${trackTitle}`);\n    } catch (err: any) {\n      toast.error(err.message || \"Withdraw failed\");\n    }\n  };\n\n  const handleShareBlink = async () => {\n    const success = await copyBlinkToClipboard(trackId);\n    if (success) toast.success(\"Blink link copied!\");\n    else toast.error(\"Failed to copy link\");\n  };\n\n  return (\n    <div className=\"glass-card p-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-lg font-bold text-white\">Music Vault</h3>\n        <button\n          onClick={handleShareBlink}\n          className=\"flex items-center gap-1.5 rounded-lg border border-base-200 px-3 py-1.5 text-xs text-slate-400 transition-colors hover:border-accent-purple/50 hover:text-accent-purple\"\n        >\n          <Share2 className=\"h-3.5 w-3.5\" />\n          Share Blink\n        </button>\n      </div>\n\n      {/* Wallet balance */}\n      {publicKey && (\n        <div className=\"mt-3 flex items-center gap-2 rounded-lg bg-base-50 px-3 py-2\">\n          <Wallet className=\"h-3.5 w-3.5 text-slate-400\" />\n          <span className=\"text-xs text-slate-400\">Your USDC:</span>\n          <span className=\"text-xs font-semibold text-white\">\n            {balanceUSDC != null ? `$${balanceUSDC.toFixed(2)}` : \"...\"}\n          </span>\n          {balanceUSDC != null && balanceUSDC === 0 && (\n            <span className=\"ml-auto text-[10px] text-yellow-400\">No USDC</span>\n          )}\n        </div>\n      )}\n\n      {/* Vault stats */}\n      <div className=\"mt-5 grid grid-cols-3 gap-4\">\n        <div>\n          <p className=\"text-[10px] uppercase tracking-wider text-slate-500\">Total Backed</p>\n          <p className=\"mt-1 text-lg font-bold text-white\">\n            {vault ? formatUSDC(vault.totalDeposited) : \"--\"}\n          </p>\n        </div>\n        <div>\n          <p className=\"text-[10px] uppercase tracking-wider text-slate-500\">Vault Cap</p>\n          <p className=\"mt-1 text-lg font-bold text-white\">\n            {vault ? formatUSDC(vault.cap) : \"--\"}\n          </p>\n        </div>\n        <div>\n          <p className=\"text-[10px] uppercase tracking-wider text-slate-500\">Share Price</p>\n          <p className=\"mt-1 flex items-center gap-1 text-lg font-bold text-accent-cyan\">\n            <TrendingUp className=\"h-4 w-4\" />\n            ${sharePrice.toFixed(4)}\n          </p>\n        </div>\n      </div>\n\n      {/* Yield distributed row */}\n      {vault && totalYieldDistributed > 0 && (\n        <div className=\"mt-3 flex items-center gap-2 rounded-lg border border-accent-cyan/20 bg-accent-cyan/5 px-3 py-2\">\n          <Zap className=\"h-3.5 w-3.5 text-accent-cyan\" />\n          <span className=\"text-xs text-slate-400\">Yield distributed by artist:</span>\n          <span className=\"ml-auto text-xs font-semibold text-accent-cyan\">\n            {formatUSDC(totalYieldDistributed)}\n          </span>\n        </div>\n      )}\n\n      {/* Progress bar */}\n      <div className=\"mt-4\">\n        <div className=\"flex items-center justify-between text-xs text-slate-500\">\n          <span className={isCapReached ? \"font-semibold text-yellow-400\" : \"\"}>\n            {isCapReached ? \"Vault Full\" : `${progress.toFixed(1)}% funded`}\n          </span>\n          <span>{vault ? `${(vault.totalShares / 10 ** USDC_DECIMALS).toFixed(0)} shares minted` : \"\"}</span>\n        </div>\n        <div className=\"vault-progress mt-1.5 h-2\">\n          <div\n            className={`vault-progress-bar ${isCapReached ? \"bg-yellow-400\" : \"\"}`}\n            style={{ width: `${progress}%` }}\n          />\n        </div>\n        {isCapReached && (\n          <p className=\"mt-1.5 flex items-center gap-1 text-[11px] text-yellow-400\">\n            <Lock className=\"h-3 w-3\" />\n            This vault has reached its funding cap — no new deposits accepted.\n          </p>\n        )}\n      </div>\n\n      {/* User position */}\n      {position && (\n        <div className=\"mt-4 rounded-xl border border-accent-purple/20 bg-accent-purple/5 p-3\">\n          <p className=\"text-[10px] uppercase tracking-wider text-accent-purple\">Your Position</p>\n          <div className=\"mt-2 flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-semibold text-white\">\n                {(position.sharesHeld / 10 ** USDC_DECIMALS).toLocaleString(\"en-US\", {\n                  minimumFractionDigits: 2,\n                  maximumFractionDigits: 2,\n                })}{\" \"}\n                shares\n              </p>\n              <p className=\"text-xs text-slate-400\">\n                {formatUSDC(position.totalDeposited)} deposited\n              </p>\n            </div>\n            <div className=\"text-right\">\n              <p className={`text-sm font-semibold ${yieldEarned > 0 ? \"text-accent-cyan\" : \"text-slate-400\"}`}>\n                +{formatUSDC(yieldEarned)}\n              </p>\n              <p className=\"text-xs text-slate-400\">\n                {realApy !== null\n                  ? `${formatPct(realApy)} APY`\n                  : yieldEarned === 0\n                  ? \"yield pending\"\n                  : \"yield earned\"}\n              </p>\n            </div>\n          </div>\n          {currentPositionValue > 0 && (\n            <div className=\"mt-2 border-t border-accent-purple/10 pt-2 flex items-center justify-between text-[11px]\">\n              <span className=\"text-slate-500\">Current value</span>\n              <span className=\"font-semibold text-white\">{formatUSDC(currentPositionValue)}</span>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Tabs */}\n      <div className=\"mt-5 flex gap-1 rounded-xl bg-base-50 p-1\">\n        <button\n          onClick={() => setActiveTab(\"deposit\")}\n          className={`flex-1 rounded-lg py-2 text-sm font-medium transition-colors ${\n            activeTab === \"deposit\"\n              ? \"bg-accent-purple/20 text-accent-purple\"\n              : \"text-slate-400 hover:text-slate-300\"\n          }`}\n        >\n          Deposit\n        </button>\n        <button\n          onClick={() => setActiveTab(\"withdraw\")}\n          className={`flex-1 rounded-lg py-2 text-sm font-medium transition-colors ${\n            activeTab === \"withdraw\"\n              ? \"bg-accent-cyan/20 text-accent-cyan\"\n              : \"text-slate-400 hover:text-slate-300\"\n          }`}\n        >\n          Withdraw\n        </button>\n      </div>\n\n      {/* Input */}\n      <div className=\"mt-4\">\n        {activeTab === \"deposit\" ? (\n          <div>\n            {isCapReached ? (\n              <div className=\"rounded-xl border border-yellow-500/20 bg-yellow-500/5 p-4 text-center\">\n                <Lock className=\"mx-auto mb-2 h-5 w-5 text-yellow-400\" />\n                <p className=\"text-sm font-medium text-yellow-400\">Vault is full</p>\n                <p className=\"mt-1 text-xs text-slate-500\">\n                  This vault has reached its funding cap. No new deposits are accepted.\n                </p>\n              </div>\n            ) : (\n              <>\n                <div className=\"relative\">\n                  <input\n                    type=\"number\"\n                    value={depositAmount}\n                    onChange={(e) => setDepositAmount(e.target.value)}\n                    placeholder=\"0.00\"\n                    min=\"0\"\n                    step=\"0.01\"\n                    className=\"h-12 w-full rounded-xl border border-base-200 bg-base-50 pl-4 pr-16 text-lg text-white outline-none transition-colors focus:border-accent-purple/50\"\n                  />\n                  <span className=\"absolute right-4 top-1/2 -translate-y-1/2 text-sm font-medium text-slate-400\">\n                    USDC\n                  </span>\n                </div>\n                <div className=\"mt-2 flex gap-2\">\n                  {[10, 25, 50, 100].map((amt) => (\n                    <button\n                      key={amt}\n                      onClick={() => setDepositAmount(amt.toString())}\n                      className=\"flex-1 rounded-lg border border-base-200 py-1.5 text-xs text-slate-400 transition-colors hover:border-accent-purple/30 hover:text-accent-purple\"\n                    >\n                      ${amt}\n                    </button>\n                  ))}\n                </div>\n                <button\n                  onClick={handleDeposit}\n                  disabled={!publicKey || !vault || deposit.isPending || !depositAmount || parseFloat(depositAmount) <= 0}\n                  className=\"btn-primary mt-3 flex w-full items-center justify-center gap-2\"\n                >\n                  {deposit.isPending ? (\n                    <Loader2 className=\"h-4 w-4 animate-spin\" />\n                  ) : (\n                    <ArrowDownToLine className=\"h-4 w-4\" />\n                  )}\n                  {!publicKey ? \"Connect Wallet\" : !vault ? \"No Vault Yet\" : deposit.isPending ? \"Backing...\" : \"Back This Track\"}\n                </button>\n              </>\n            )}\n          </div>\n        ) : (\n          <div>\n            <div className=\"relative\">\n              <input\n                type=\"number\"\n                value={withdrawAmount}\n                onChange={(e) => setWithdrawAmount(e.target.value)}\n                placeholder=\"0.00\"\n                min=\"0\"\n                step=\"0.01\"\n                className=\"h-12 w-full rounded-xl border border-base-200 bg-base-50 pl-4 pr-20 text-lg text-white outline-none transition-colors focus:border-accent-cyan/50\"\n              />\n              <span className=\"absolute right-4 top-1/2 -translate-y-1/2 text-sm font-medium text-slate-400\">\n                Shares\n              </span>\n            </div>\n            {position && (\n              <button\n                onClick={() => setWithdrawAmount((position.sharesHeld / 10 ** USDC_DECIMALS).toString())}\n                className=\"mt-2 text-xs text-accent-cyan hover:underline\"\n              >\n                Max: {(position.sharesHeld / 10 ** USDC_DECIMALS).toFixed(2)} shares\n                {yieldEarned > 0 && ` (+${formatUSDC(yieldEarned)} yield)`}\n              </button>\n            )}\n            <button\n              onClick={handleWithdraw}\n              disabled={!publicKey || withdraw.isPending || !withdrawAmount || parseFloat(withdrawAmount) <= 0}\n              className=\"btn-secondary mt-3 flex w-full items-center justify-center gap-2\"\n            >\n              {withdraw.isPending ? (\n                <Loader2 className=\"h-4 w-4 animate-spin\" />\n              ) : (\n                <ArrowUpFromLine className=\"h-4 w-4\" />\n              )}\n              {withdraw.isPending ? \"Withdrawing...\" : \"Withdraw\"}\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* Last transaction */}\n      {lastTxHash && (\n        <div className=\"mt-4 flex items-center justify-center gap-2 rounded-lg border border-accent-cyan/20 bg-accent-cyan/5 px-3 py-2\">\n          <span className=\"text-xs text-slate-400\">Last tx:</span>\n          <a\n            href={explorerUrl(lastTxHash)}\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            className=\"flex items-center gap-1 text-xs font-medium text-accent-cyan hover:underline\"\n          >\n            {lastTxHash.slice(0, 8)}...{lastTxHash.slice(-8)}\n            <ExternalLink className=\"h-3 w-3\" />\n          </a>\n        </div>\n      )}\n\n      {/* Vault not initialized */}\n      {!vaultLoading && !vault && (\n        <div className=\"mt-4 rounded-xl border border-yellow-500/20 bg-yellow-500/5 p-4 text-center\">\n          {isArtist ? (\n            <>\n              <p className=\"text-xs text-yellow-400 mb-3\">\n                No vault exists for this track yet. Create one via the Artist Portal.\n              </p>\n              <Link href=\"/artist/register\" className=\"btn-primary inline-flex items-center gap-2 text-sm\">\n                Create Vault in Artist Portal\n              </Link>\n            </>\n          ) : (\n            <>\n              <p className=\"text-xs text-yellow-400 mb-2\">No vault exists for this track yet.</p>\n              <p className=\"text-[11px] text-slate-500\">\n                Only the artist can create a vault.{\" \"}\n                <Link href=\"/artist\" className=\"text-accent-purple hover:underline\">\n                  Are you the artist?\n                </Link>\n              </p>\n            </>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1637, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/components/player/TrackPlayer.tsx"],"sourcesContent":["\"use client\";\n\nimport { useRef, useState, useEffect, useCallback } from \"react\";\nimport { Play, Pause, Volume2, VolumeX, SkipBack, SkipForward, AlertCircle } from \"lucide-react\";\nimport { getTrackStreamUrl } from \"@/services/audius\";\n\ninterface TrackPlayerProps {\n  trackId: string;\n  title: string;\n  artist: string;\n  artwork: string;\n  compact?: boolean;\n}\n\nfunction formatTime(seconds: number): string {\n  if (!isFinite(seconds) || seconds < 0) return \"0:00\";\n  const mins = Math.floor(seconds / 60);\n  const secs = Math.floor(seconds % 60);\n  return `${mins}:${secs.toString().padStart(2, \"0\")}`;\n}\n\nexport function TrackPlayer({\n  trackId,\n  title,\n  artist,\n  artwork,\n  compact = false,\n}: TrackPlayerProps) {\n  const audioRef = useRef<HTMLAudioElement | null>(null);\n  const progressRef = useRef<HTMLDivElement>(null);\n\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [duration, setDuration] = useState(0);\n  const [volume, setVolume] = useState(0.7);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isLoading, setIsLoading] = useState(true); // true while metadata loads\n  const [error, setError] = useState<string | null>(null);\n\n  const streamUrl = getTrackStreamUrl(trackId);\n\n  // Initialize audio and load metadata immediately so duration is available\n  useEffect(() => {\n    setIsPlaying(false);\n    setCurrentTime(0);\n    setDuration(0);\n    setIsLoading(true);\n    setError(null);\n\n    const audio = new Audio();\n    audio.preload = \"metadata\";\n    audio.volume = volume;\n    // Set src immediately — this triggers the browser to fetch metadata\n    // (including duration) without downloading the full stream.\n    audio.src = streamUrl;\n    audioRef.current = audio;\n\n    const onLoadedMetadata = () => {\n      if (isFinite(audio.duration)) setDuration(audio.duration);\n      setIsLoading(false);\n    };\n    const onTimeUpdate = () => setCurrentTime(audio.currentTime);\n    const onDurationChange = () => {\n      if (isFinite(audio.duration) && audio.duration > 0) setDuration(audio.duration);\n    };\n    const onEnded = () => { setIsPlaying(false); setCurrentTime(0); };\n    const onWaiting = () => setIsLoading(true);\n    const onCanPlay = () => setIsLoading(false);\n    const onError = () => {\n      setIsLoading(false);\n      setIsPlaying(false);\n      setError(\"Stream unavailable — the track may be restricted or offline.\");\n    };\n\n    audio.addEventListener(\"loadedmetadata\", onLoadedMetadata);\n    audio.addEventListener(\"timeupdate\", onTimeUpdate);\n    audio.addEventListener(\"durationchange\", onDurationChange);\n    audio.addEventListener(\"ended\", onEnded);\n    audio.addEventListener(\"waiting\", onWaiting);\n    audio.addEventListener(\"canplay\", onCanPlay);\n    audio.addEventListener(\"error\", onError);\n\n    return () => {\n      audio.pause();\n      audio.src = \"\";\n      audio.removeEventListener(\"loadedmetadata\", onLoadedMetadata);\n      audio.removeEventListener(\"timeupdate\", onTimeUpdate);\n      audio.removeEventListener(\"durationchange\", onDurationChange);\n      audio.removeEventListener(\"ended\", onEnded);\n      audio.removeEventListener(\"waiting\", onWaiting);\n      audio.removeEventListener(\"canplay\", onCanPlay);\n      audio.removeEventListener(\"error\", onError);\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [streamUrl]);\n\n  const togglePlay = useCallback(async () => {\n    const audio = audioRef.current;\n    if (!audio || error) return;\n\n    if (isPlaying) {\n      audio.pause();\n      setIsPlaying(false);\n    } else {\n      setIsLoading(true);\n      try {\n        await audio.play();\n        setIsPlaying(true);\n        setIsLoading(false);\n      } catch (e: any) {\n        setIsLoading(false);\n        // NotAllowedError = browser autoplay policy, anything else is a real error\n        if (e?.name !== \"AbortError\") {\n          setError(\"Playback failed. The stream may not be available in your region.\");\n        }\n      }\n    }\n  }, [isPlaying, error]);\n\n  const seek = useCallback(\n    (e: React.MouseEvent<HTMLDivElement>) => {\n      const audio = audioRef.current;\n      const bar = progressRef.current;\n      if (!audio || !bar || !duration) return;\n\n      const rect = bar.getBoundingClientRect();\n      const percent = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));\n      audio.currentTime = percent * duration;\n    },\n    [duration]\n  );\n\n  const toggleMute = useCallback(() => {\n    const audio = audioRef.current;\n    if (!audio) return;\n    audio.muted = !isMuted;\n    setIsMuted(!isMuted);\n  }, [isMuted]);\n\n  const handleVolumeChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const val = parseFloat(e.target.value);\n    setVolume(val);\n    if (audioRef.current) audioRef.current.volume = val;\n    if (val > 0 && isMuted) {\n      setIsMuted(false);\n      if (audioRef.current) audioRef.current.muted = false;\n    }\n  }, [isMuted]);\n\n  const skipBy = useCallback((seconds: number) => {\n    const audio = audioRef.current;\n    if (!audio) return;\n    audio.currentTime = Math.max(0, Math.min(audio.currentTime + seconds, duration));\n  }, [duration]);\n\n  const progress = duration > 0 ? (currentTime / duration) * 100 : 0;\n\n  // ─── compact mode ────────────────────────────────────────────────────────────\n  if (compact) {\n    return (\n      <div className=\"flex items-center gap-3\">\n        <button\n          onClick={togglePlay}\n          disabled={!!error}\n          className=\"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full bg-gradient-primary text-white transition-transform hover:scale-105 disabled:opacity-40\"\n        >\n          {isLoading ? (\n            <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent\" />\n          ) : isPlaying ? (\n            <Pause className=\"h-4 w-4\" />\n          ) : (\n            <Play className=\"h-4 w-4 ml-0.5\" />\n          )}\n        </button>\n        <div className=\"flex-1 min-w-0\">\n          <div\n            ref={progressRef}\n            onClick={seek}\n            className=\"vault-progress h-1.5 cursor-pointer\"\n          >\n            <div className=\"vault-progress-bar\" style={{ width: `${progress}%` }} />\n          </div>\n          <div className=\"mt-1 flex justify-between text-[10px] text-slate-500\">\n            <span>{formatTime(currentTime)}</span>\n            <span>{formatTime(duration)}</span>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // ─── full mode ───────────────────────────────────────────────────────────────\n  return (\n    <div className=\"glass-card p-4\">\n      <div className=\"flex items-center gap-4\">\n        {/* Artwork */}\n        <div className=\"relative h-14 w-14 flex-shrink-0 overflow-hidden rounded-xl\">\n          <img\n            src={artwork || \"/placeholder-track.svg\"}\n            alt={title}\n            className=\"h-full w-full object-cover\"\n            onError={(e) => { (e.target as HTMLImageElement).src = \"/placeholder-track.svg\"; }}\n          />\n          {isPlaying && (\n            <div className=\"absolute inset-0 flex items-center justify-center bg-black/30\">\n              <div className=\"flex items-end gap-0.5 h-4\">\n                {[0, 150, 300, 450].map((delay) => (\n                  <div\n                    key={delay}\n                    className=\"w-0.5 animate-pulse bg-accent-cyan rounded-full\"\n                    style={{ height: delay % 300 === 0 ? \"60%\" : delay % 150 === 0 ? \"100%\" : \"40%\", animationDelay: `${delay}ms` }}\n                  />\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Info */}\n        <div className=\"flex-1 min-w-0\">\n          <p className=\"truncate text-sm font-semibold text-white\">{title}</p>\n          <p className=\"truncate text-xs text-slate-400\">{artist}</p>\n        </div>\n\n        {/* Controls */}\n        <div className=\"flex items-center gap-2\">\n          <button\n            onClick={() => skipBy(-10)}\n            disabled={!duration}\n            className=\"text-slate-400 transition-colors hover:text-white disabled:opacity-30\"\n          >\n            <SkipBack className=\"h-4 w-4\" />\n          </button>\n\n          <button\n            onClick={togglePlay}\n            disabled={!!error}\n            className=\"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-primary text-white transition-transform hover:scale-105 disabled:opacity-40\"\n          >\n            {isLoading ? (\n              <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent\" />\n            ) : isPlaying ? (\n              <Pause className=\"h-4 w-4\" />\n            ) : (\n              <Play className=\"h-4 w-4 ml-0.5\" />\n            )}\n          </button>\n\n          <button\n            onClick={() => skipBy(10)}\n            disabled={!duration}\n            className=\"text-slate-400 transition-colors hover:text-white disabled:opacity-30\"\n          >\n            <SkipForward className=\"h-4 w-4\" />\n          </button>\n        </div>\n\n        {/* Volume */}\n        <div className=\"hidden items-center gap-2 sm:flex\">\n          <button onClick={toggleMute} className=\"text-slate-400 transition-colors hover:text-white\">\n            {isMuted || volume === 0 ? (\n              <VolumeX className=\"h-4 w-4\" />\n            ) : (\n              <Volume2 className=\"h-4 w-4\" />\n            )}\n          </button>\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"1\"\n            step=\"0.01\"\n            value={isMuted ? 0 : volume}\n            onChange={handleVolumeChange}\n            className=\"h-1 w-20 cursor-pointer appearance-none rounded-full bg-base-200 accent-accent-purple\"\n          />\n        </div>\n      </div>\n\n      {/* Progress bar */}\n      <div className=\"mt-3\">\n        <div\n          ref={progressRef}\n          onClick={seek}\n          className=\"vault-progress h-2 cursor-pointer\"\n        >\n          <div className=\"vault-progress-bar\" style={{ width: `${progress}%` }} />\n        </div>\n        <div className=\"mt-1 flex justify-between text-[10px] text-slate-500\">\n          <span>{formatTime(currentTime)}</span>\n          <span>{isLoading && duration === 0 ? \"—:——\" : formatTime(duration)}</span>\n        </div>\n      </div>\n\n      {/* Error state */}\n      {error && (\n        <div className=\"mt-3 flex items-center gap-2 rounded-lg border border-red-500/20 bg-red-500/5 px-3 py-2\">\n          <AlertCircle className=\"h-4 w-4 flex-shrink-0 text-red-400\" />\n          <p className=\"text-xs text-red-400\">{error}</p>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;AAJA;;;;AAcA,SAAS,WAAW,OAAe;IACjC,IAAI,CAAC,SAAS,YAAY,UAAU,GAAG,OAAO;IAC9C,MAAM,OAAO,KAAK,KAAK,CAAC,UAAU;IAClC,MAAM,OAAO,KAAK,KAAK,CAAC,UAAU;IAClC,OAAO,GAAG,KAAK,CAAC,EAAE,KAAK,QAAQ,GAAG,QAAQ,CAAC,GAAG,MAAM;AACtD;AAEO,SAAS,YAAY,EAC1B,OAAO,EACP,KAAK,EACL,MAAM,EACN,OAAO,EACP,UAAU,KAAK,EACE;;IACjB,MAAM,WAAW,IAAA,wUAAM,EAA0B;IACjD,MAAM,cAAc,IAAA,wUAAM,EAAiB;IAE3C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,0UAAQ,EAAC;IAC3C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,0UAAQ,EAAC;IAC/C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,0UAAQ,EAAC;IACzC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,0UAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,0UAAQ,EAAC;IACvC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,0UAAQ,EAAC,OAAO,4BAA4B;IAC9E,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,0UAAQ,EAAgB;IAElD,MAAM,YAAY,IAAA,iJAAiB,EAAC;IAEpC,0EAA0E;IAC1E,IAAA,2UAAS;iCAAC;YACR,aAAa;YACb,eAAe;YACf,YAAY;YACZ,aAAa;YACb,SAAS;YAET,MAAM,QAAQ,IAAI;YAClB,MAAM,OAAO,GAAG;YAChB,MAAM,MAAM,GAAG;YACf,oEAAoE;YACpE,4DAA4D;YAC5D,MAAM,GAAG,GAAG;YACZ,SAAS,OAAO,GAAG;YAEnB,MAAM;0DAAmB;oBACvB,IAAI,SAAS,MAAM,QAAQ,GAAG,YAAY,MAAM,QAAQ;oBACxD,aAAa;gBACf;;YACA,MAAM;sDAAe,IAAM,eAAe,MAAM,WAAW;;YAC3D,MAAM;0DAAmB;oBACvB,IAAI,SAAS,MAAM,QAAQ,KAAK,MAAM,QAAQ,GAAG,GAAG,YAAY,MAAM,QAAQ;gBAChF;;YACA,MAAM;iDAAU;oBAAQ,aAAa;oBAAQ,eAAe;gBAAI;;YAChE,MAAM;mDAAY,IAAM,aAAa;;YACrC,MAAM;mDAAY,IAAM,aAAa;;YACrC,MAAM;iDAAU;oBACd,aAAa;oBACb,aAAa;oBACb,SAAS;gBACX;;YAEA,MAAM,gBAAgB,CAAC,kBAAkB;YACzC,MAAM,gBAAgB,CAAC,cAAc;YACrC,MAAM,gBAAgB,CAAC,kBAAkB;YACzC,MAAM,gBAAgB,CAAC,SAAS;YAChC,MAAM,gBAAgB,CAAC,WAAW;YAClC,MAAM,gBAAgB,CAAC,WAAW;YAClC,MAAM,gBAAgB,CAAC,SAAS;YAEhC;yCAAO;oBACL,MAAM,KAAK;oBACX,MAAM,GAAG,GAAG;oBACZ,MAAM,mBAAmB,CAAC,kBAAkB;oBAC5C,MAAM,mBAAmB,CAAC,cAAc;oBACxC,MAAM,mBAAmB,CAAC,kBAAkB;oBAC5C,MAAM,mBAAmB,CAAC,SAAS;oBACnC,MAAM,mBAAmB,CAAC,WAAW;oBACrC,MAAM,mBAAmB,CAAC,WAAW;oBACrC,MAAM,mBAAmB,CAAC,SAAS;gBACrC;;QACF,uDAAuD;QACvD;gCAAG;QAAC;KAAU;IAEd,MAAM,aAAa,IAAA,6UAAW;+CAAC;YAC7B,MAAM,QAAQ,SAAS,OAAO;YAC9B,IAAI,CAAC,SAAS,OAAO;YAErB,IAAI,WAAW;gBACb,MAAM,KAAK;gBACX,aAAa;YACf,OAAO;gBACL,aAAa;gBACb,IAAI;oBACF,MAAM,MAAM,IAAI;oBAChB,aAAa;oBACb,aAAa;gBACf,EAAE,OAAO,GAAQ;oBACf,aAAa;oBACb,2EAA2E;oBAC3E,IAAI,GAAG,SAAS,cAAc;wBAC5B,SAAS;oBACX;gBACF;YACF;QACF;8CAAG;QAAC;QAAW;KAAM;IAErB,MAAM,OAAO,IAAA,6UAAW;yCACtB,CAAC;YACC,MAAM,QAAQ,SAAS,OAAO;YAC9B,MAAM,MAAM,YAAY,OAAO;YAC/B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU;YAEjC,MAAM,OAAO,IAAI,qBAAqB;YACtC,MAAM,UAAU,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG,CAAC,EAAE,OAAO,GAAG,KAAK,IAAI,IAAI,KAAK,KAAK;YAC5E,MAAM,WAAW,GAAG,UAAU;QAChC;wCACA;QAAC;KAAS;IAGZ,MAAM,aAAa,IAAA,6UAAW;+CAAC;YAC7B,MAAM,QAAQ,SAAS,OAAO;YAC9B,IAAI,CAAC,OAAO;YACZ,MAAM,KAAK,GAAG,CAAC;YACf,WAAW,CAAC;QACd;8CAAG;QAAC;KAAQ;IAEZ,MAAM,qBAAqB,IAAA,6UAAW;uDAAC,CAAC;YACtC,MAAM,MAAM,WAAW,EAAE,MAAM,CAAC,KAAK;YACrC,UAAU;YACV,IAAI,SAAS,OAAO,EAAE,SAAS,OAAO,CAAC,MAAM,GAAG;YAChD,IAAI,MAAM,KAAK,SAAS;gBACtB,WAAW;gBACX,IAAI,SAAS,OAAO,EAAE,SAAS,OAAO,CAAC,KAAK,GAAG;YACjD;QACF;sDAAG;QAAC;KAAQ;IAEZ,MAAM,SAAS,IAAA,6UAAW;2CAAC,CAAC;YAC1B,MAAM,QAAQ,SAAS,OAAO;YAC9B,IAAI,CAAC,OAAO;YACZ,MAAM,WAAW,GAAG,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,MAAM,WAAW,GAAG,SAAS;QACxE;0CAAG;QAAC;KAAS;IAEb,MAAM,WAAW,WAAW,IAAI,AAAC,cAAc,WAAY,MAAM;IAEjE,gFAAgF;IAChF,IAAI,SAAS;QACX,qBACE,8VAAC;YAAI,WAAU;;8BACb,8VAAC;oBACC,SAAS;oBACT,UAAU,CAAC,CAAC;oBACZ,WAAU;8BAET,0BACC,8VAAC;wBAAI,WAAU;;;;;+BACb,0BACF,8VAAC,oSAAK;wBAAC,WAAU;;;;;6CAEjB,8VAAC,iSAAI;wBAAC,WAAU;;;;;;;;;;;8BAGpB,8VAAC;oBAAI,WAAU;;sCACb,8VAAC;4BACC,KAAK;4BACL,SAAS;4BACT,WAAU;sCAEV,cAAA,8VAAC;gCAAI,WAAU;gCAAqB,OAAO;oCAAE,OAAO,GAAG,SAAS,CAAC,CAAC;gCAAC;;;;;;;;;;;sCAErE,8VAAC;4BAAI,WAAU;;8CACb,8VAAC;8CAAM,WAAW;;;;;;8CAClB,8VAAC;8CAAM,WAAW;;;;;;;;;;;;;;;;;;;;;;;;IAK5B;IAEA,gFAAgF;IAChF,qBACE,8VAAC;QAAI,WAAU;;0BACb,8VAAC;gBAAI,WAAU;;kCAEb,8VAAC;wBAAI,WAAU;;0CACb,8VAAC;gCACC,KAAK,WAAW;gCAChB,KAAK;gCACL,WAAU;gCACV,SAAS,CAAC;oCAAS,EAAE,MAAM,CAAsB,GAAG,GAAG;gCAA0B;;;;;;4BAElF,2BACC,8VAAC;gCAAI,WAAU;0CACb,cAAA,8VAAC;oCAAI,WAAU;8CACZ;wCAAC;wCAAG;wCAAK;wCAAK;qCAAI,CAAC,GAAG,CAAC,CAAC,sBACvB,8VAAC;4CAEC,WAAU;4CACV,OAAO;gDAAE,QAAQ,QAAQ,QAAQ,IAAI,QAAQ,QAAQ,QAAQ,IAAI,SAAS;gDAAO,gBAAgB,GAAG,MAAM,EAAE,CAAC;4CAAC;2CAFzG;;;;;;;;;;;;;;;;;;;;;kCAWjB,8VAAC;wBAAI,WAAU;;0CACb,8VAAC;gCAAE,WAAU;0CAA6C;;;;;;0CAC1D,8VAAC;gCAAE,WAAU;0CAAmC;;;;;;;;;;;;kCAIlD,8VAAC;wBAAI,WAAU;;0CACb,8VAAC;gCACC,SAAS,IAAM,OAAO,CAAC;gCACvB,UAAU,CAAC;gCACX,WAAU;0CAEV,cAAA,8VAAC,iTAAQ;oCAAC,WAAU;;;;;;;;;;;0CAGtB,8VAAC;gCACC,SAAS;gCACT,UAAU,CAAC,CAAC;gCACZ,WAAU;0CAET,0BACC,8VAAC;oCAAI,WAAU;;;;;2CACb,0BACF,8VAAC,oSAAK;oCAAC,WAAU;;;;;yDAEjB,8VAAC,iSAAI;oCAAC,WAAU;;;;;;;;;;;0CAIpB,8VAAC;gCACC,SAAS,IAAM,OAAO;gCACtB,UAAU,CAAC;gCACX,WAAU;0CAEV,cAAA,8VAAC,0TAAW;oCAAC,WAAU;;;;;;;;;;;;;;;;;kCAK3B,8VAAC;wBAAI,WAAU;;0CACb,8VAAC;gCAAO,SAAS;gCAAY,WAAU;0CACpC,WAAW,WAAW,kBACrB,8VAAC,8SAAO;oCAAC,WAAU;;;;;yDAEnB,8VAAC,8SAAO;oCAAC,WAAU;;;;;;;;;;;0CAGvB,8VAAC;gCACC,MAAK;gCACL,KAAI;gCACJ,KAAI;gCACJ,MAAK;gCACL,OAAO,UAAU,IAAI;gCACrB,UAAU;gCACV,WAAU;;;;;;;;;;;;;;;;;;0BAMhB,8VAAC;gBAAI,WAAU;;kCACb,8VAAC;wBACC,KAAK;wBACL,SAAS;wBACT,WAAU;kCAEV,cAAA,8VAAC;4BAAI,WAAU;4BAAqB,OAAO;gCAAE,OAAO,GAAG,SAAS,CAAC,CAAC;4BAAC;;;;;;;;;;;kCAErE,8VAAC;wBAAI,WAAU;;0CACb,8VAAC;0CAAM,WAAW;;;;;;0CAClB,8VAAC;0CAAM,aAAa,aAAa,IAAI,SAAS,WAAW;;;;;;;;;;;;;;;;;;YAK5D,uBACC,8VAAC;gBAAI,WAAU;;kCACb,8VAAC,0TAAW;wBAAC,WAAU;;;;;;kCACvB,8VAAC;wBAAE,WAAU;kCAAwB;;;;;;;;;;;;;;;;;;AAK/C;GAzRgB;KAAA"}},
    {"offset": {"line": 2204, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/app/track/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useParams } from \"next/navigation\";\nimport { useTrack } from \"@/hooks/useAudius\";\nimport { VaultPanel } from \"@/components/track/VaultPanel\";\nimport { TrackPlayer } from \"@/components/player/TrackPlayer\";\nimport {\n  ArrowLeft,\n  Play,\n  Heart,\n  Share2,\n  Users,\n  Clock,\n  ExternalLink,\n} from \"lucide-react\";\nimport Link from \"next/link\";\n\nfunction formatNumber(n: number): string {\n  if (n >= 1_000_000) return `${(n / 1_000_000).toFixed(1)}M`;\n  if (n >= 1_000) return `${(n / 1_000).toFixed(1)}K`;\n  return n.toString();\n}\n\nfunction formatDuration(seconds: number): string {\n  const mins = Math.floor(seconds / 60);\n  const secs = seconds % 60;\n  return `${mins}:${secs.toString().padStart(2, \"0\")}`;\n}\n\nexport default function TrackPage() {\n  const params = useParams();\n  const trackId = params.id as string;\n  const { data: track, isLoading } = useTrack(trackId);\n\n  if (isLoading) {\n    return (\n      <div className=\"flex min-h-[60vh] items-center justify-center\">\n        <div className=\"h-10 w-10 animate-spin rounded-full border-2 border-accent-purple border-t-transparent\" />\n      </div>\n    );\n  }\n\n  if (!track) {\n    return (\n      <div className=\"flex min-h-[60vh] flex-col items-center justify-center gap-4\">\n        <p className=\"text-lg text-slate-400\">Track not found</p>\n        <Link href=\"/\" className=\"btn-secondary text-sm\">\n          Go back\n        </Link>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"mx-auto max-w-7xl px-4 py-8 sm:px-6\">\n      {/* Back button */}\n      <Link\n        href=\"/\"\n        className=\"mb-6 inline-flex items-center gap-1.5 text-sm text-slate-400 transition-colors hover:text-white\"\n      >\n        <ArrowLeft className=\"h-4 w-4\" />\n        Back to explore\n      </Link>\n\n      <div className=\"grid gap-8 lg:grid-cols-[1fr_400px]\">\n        {/* Left: Track info */}\n        <div>\n          {/* Track header */}\n          <div className=\"flex gap-6\">\n            {/* Artwork */}\n            <div className=\"relative h-48 w-48 flex-shrink-0 overflow-hidden rounded-2xl shadow-2xl shadow-accent-purple/20\">\n              <img\n                src={track.artwork?.[\"480x480\"] || \"/placeholder-track.svg\"}\n                alt={track.title}\n                className=\"h-full w-full object-cover\"\n                onError={(e) => { (e.target as HTMLImageElement).src = \"/placeholder-track.svg\"; }}\n              />\n              <div className=\"absolute inset-0 flex items-center justify-center bg-black/30 opacity-0 transition-opacity hover:opacity-100\">\n                <Play className=\"h-12 w-12 text-white\" />\n              </div>\n            </div>\n\n            {/* Details */}\n            <div className=\"flex flex-col justify-center\">\n              {track.genre && (\n                <span className=\"mb-2 w-fit rounded-lg bg-accent-purple/15 px-2.5 py-0.5 text-[11px] font-semibold uppercase tracking-wider text-accent-purple\">\n                  {track.genre}\n                </span>\n              )}\n              <h1 className=\"text-2xl font-extrabold text-white sm:text-3xl\">\n                {track.title}\n              </h1>\n              <Link\n                href={`https://audius.co/${track.user.handle}`}\n                target=\"_blank\"\n                className=\"mt-1 flex items-center gap-2 text-slate-400 transition-colors hover:text-accent-cyan\"\n              >\n                <img\n                  src={track.user.profile_picture?.[\"150x150\"] || \"/placeholder-avatar.svg\"}\n                  alt={track.user.name}\n                  className=\"h-6 w-6 rounded-full object-cover\"\n                  onError={(e) => { (e.target as HTMLImageElement).src = \"/placeholder-avatar.svg\"; }}\n                />\n                <span className=\"font-medium\">{track.user.name}</span>\n                <ExternalLink className=\"h-3 w-3\" />\n              </Link>\n\n              {/* Stats */}\n              <div className=\"mt-4 flex flex-wrap gap-4 text-sm text-slate-400\">\n                <span className=\"flex items-center gap-1.5\">\n                  <Play className=\"h-4 w-4 text-accent-cyan\" />\n                  {formatNumber(track.play_count)} plays\n                </span>\n                <span className=\"flex items-center gap-1.5\">\n                  <Heart className=\"h-4 w-4 text-accent-pink\" />\n                  {formatNumber(track.favorite_count)} favorites\n                </span>\n                <span className=\"flex items-center gap-1.5\">\n                  <Users className=\"h-4 w-4 text-accent-purple\" />\n                  {formatNumber(track.repost_count)} reposts\n                </span>\n                <span className=\"flex items-center gap-1.5\">\n                  <Clock className=\"h-4 w-4 text-slate-500\" />\n                  {formatDuration(track.duration)}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* Player */}\n          <div className=\"mt-6\">\n            <TrackPlayer\n              trackId={trackId}\n              title={track.title}\n              artist={track.user.name}\n              artwork={track.artwork?.[\"150x150\"] || \"/placeholder-track.svg\"}\n            />\n          </div>\n\n          {/* Description */}\n          {track.description && (\n            <div className=\"mt-8\">\n              <h3 className=\"text-sm font-semibold text-slate-300\">About</h3>\n              <p className=\"mt-2 text-sm leading-relaxed text-slate-400\">\n                {track.description}\n              </p>\n            </div>\n          )}\n\n          {/* Popularity signal */}\n          <div className=\"mt-8 glass-card p-5\">\n            <h3 className=\"text-sm font-semibold text-white\">\n              Popularity Signal\n            </h3>\n            <p className=\"mt-1 text-xs text-slate-400\">\n              Track metrics from Audius used to calculate yield boost\n            </p>\n            <div className=\"mt-4 grid grid-cols-2 gap-4 sm:grid-cols-4\">\n              {[\n                {\n                  label: \"Play Score\",\n                  value: Math.min(Math.floor(track.play_count / 100), 100),\n                  max: 100,\n                },\n                {\n                  label: \"Fan Score\",\n                  value: Math.min(\n                    Math.floor(track.favorite_count / 10),\n                    100\n                  ),\n                  max: 100,\n                },\n                {\n                  label: \"Viral Score\",\n                  value: Math.min(\n                    Math.floor(track.repost_count / 10),\n                    100\n                  ),\n                  max: 100,\n                },\n                {\n                  label: \"Boost\",\n                  value: Math.min(\n                    Math.floor(\n                      (track.play_count + track.favorite_count * 5) / 500\n                    ),\n                    50\n                  ),\n                  max: 50,\n                  suffix: \"%\",\n                },\n              ].map((metric) => (\n                <div key={metric.label}>\n                  <div className=\"flex items-center justify-between text-xs\">\n                    <span className=\"text-slate-500\">{metric.label}</span>\n                    <span className=\"font-medium text-white\">\n                      {metric.value}\n                      {metric.suffix || `/${metric.max}`}\n                    </span>\n                  </div>\n                  <div className=\"vault-progress mt-1.5 h-1.5\">\n                    <div\n                      className=\"vault-progress-bar\"\n                      style={{\n                        width: `${(metric.value / metric.max) * 100}%`,\n                      }}\n                    />\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n\n        {/* Right: Vault panel */}\n        <div className=\"space-y-4\">\n          <VaultPanel trackId={trackId} trackTitle={track.title} artistUserId={track.user.id} />\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}