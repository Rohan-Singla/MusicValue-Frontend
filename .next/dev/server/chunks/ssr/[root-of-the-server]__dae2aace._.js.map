{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/hooks/useAudiusAuth.ts"],"sourcesContent":["\"use client\";\n\nimport { useContext } from \"react\";\nimport { AudiusAuthContext } from \"@/providers/AudiusAuthProvider\";\n\nexport function useAudiusAuth() {\n  const ctx = useContext(AudiusAuthContext);\n  if (!ctx) {\n    throw new Error(\"useAudiusAuth must be used inside AudiusAuthProvider\");\n  }\n  return ctx;\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAKO,SAAS;IACd,MAAM,MAAM,IAAA,oXAAU,EAAC,4JAAiB;IACxC,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/components/artist/AudiusLoginButton.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useAudiusAuth } from \"@/hooks/useAudiusAuth\";\nimport { Loader2, LogOut, Music, CheckCircle } from \"lucide-react\";\nimport toast from \"react-hot-toast\";\n\ninterface AudiusLoginButtonProps {\n  className?: string;\n  onSuccess?: () => void;\n}\n\nexport function AudiusLoginButton({ className = \"\", onSuccess }: AudiusLoginButtonProps) {\n  const { user, isLoading, login, logout } = useAudiusAuth();\n  const [pending, setPending] = useState(false);\n\n  const handleLogin = async () => {\n    setPending(true);\n    try {\n      await login();\n      toast.success(\"Connected to Audius!\");\n      onSuccess?.();\n    } catch (err: any) {\n      toast.error(err.message || \"Audius login failed\");\n    } finally {\n      setPending(false);\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className={`flex h-10 items-center gap-2 rounded-xl border border-base-200 px-4 ${className}`}>\n        <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-accent-purple border-t-transparent\" />\n        <span className=\"text-sm text-slate-400\">Loading...</span>\n      </div>\n    );\n  }\n\n  if (user) {\n    return (\n      <div className={`flex items-center gap-3 ${className}`}>\n        <div className=\"flex items-center gap-2 rounded-xl border border-green-500/20 bg-green-500/5 px-3 py-2\">\n          {user.profilePicture ? (\n            <img\n              src={user.profilePicture}\n              alt={user.name}\n              className=\"h-7 w-7 rounded-full object-cover ring-1 ring-green-500/30\"\n              onError={(e) => { (e.target as HTMLImageElement).src = \"/placeholder-avatar.svg\"; }}\n            />\n          ) : (\n            <div className=\"flex h-7 w-7 items-center justify-center rounded-full bg-green-500/20\">\n              <Music className=\"h-3.5 w-3.5 text-green-400\" />\n            </div>\n          )}\n          <div className=\"leading-none\">\n            <p className=\"flex items-center gap-1 text-sm font-semibold text-white\">\n              <CheckCircle className=\"h-3 w-3 text-green-400\" />\n              {user.name}\n            </p>\n            <p className=\"text-[10px] text-slate-400\">@{user.handle}</p>\n          </div>\n        </div>\n        <button\n          onClick={logout}\n          className=\"flex items-center gap-1.5 rounded-xl border border-base-200 px-3 py-2 text-sm text-slate-400 transition-colors hover:border-red-500/30 hover:text-red-400\"\n        >\n          <LogOut className=\"h-4 w-4\" />\n          Disconnect\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <button\n      onClick={handleLogin}\n      disabled={pending}\n      className={`btn-primary flex items-center gap-2 ${className}`}\n    >\n      {pending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Music className=\"h-4 w-4\" />}\n      {pending ? \"Connecting...\" : \"Connect Audius\"}\n    </button>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AALA;;;;;;AAYO,SAAS,kBAAkB,EAAE,YAAY,EAAE,EAAE,SAAS,EAA0B;IACrF,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,IAAA,8IAAa;IACxD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kXAAQ,EAAC;IAEvC,MAAM,cAAc;QAClB,WAAW;QACX,IAAI;YACF,MAAM;YACN,iTAAK,CAAC,OAAO,CAAC;YACd;QACF,EAAE,OAAO,KAAU;YACjB,iTAAK,CAAC,KAAK,CAAC,IAAI,OAAO,IAAI;QAC7B,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAI,WAAW;QACb,qBACE,+YAAC;YAAI,WAAW,CAAC,oEAAoE,EAAE,WAAW;;8BAChG,+YAAC;oBAAI,WAAU;;;;;;8BACf,+YAAC;oBAAK,WAAU;8BAAyB;;;;;;;;;;;;IAG/C;IAEA,IAAI,MAAM;QACR,qBACE,+YAAC;YAAI,WAAW,CAAC,wBAAwB,EAAE,WAAW;;8BACpD,+YAAC;oBAAI,WAAU;;wBACZ,KAAK,cAAc,iBAClB,+YAAC;4BACC,KAAK,KAAK,cAAc;4BACxB,KAAK,KAAK,IAAI;4BACd,WAAU;4BACV,SAAS,CAAC;gCAAS,EAAE,MAAM,CAAsB,GAAG,GAAG;4BAA2B;;;;;iDAGpF,+YAAC;4BAAI,WAAU;sCACb,cAAA,+YAAC,iSAAK;gCAAC,WAAU;;;;;;;;;;;sCAGrB,+YAAC;4BAAI,WAAU;;8CACb,+YAAC;oCAAE,WAAU;;sDACX,+YAAC,8TAAW;4CAAC,WAAU;;;;;;wCACtB,KAAK,IAAI;;;;;;;8CAEZ,+YAAC;oCAAE,WAAU;;wCAA6B;wCAAE,KAAK,MAAM;;;;;;;;;;;;;;;;;;;8BAG3D,+YAAC;oBACC,SAAS;oBACT,WAAU;;sCAEV,+YAAC,wSAAM;4BAAC,WAAU;;;;;;wBAAY;;;;;;;;;;;;;IAKtC;IAEA,qBACE,+YAAC;QACC,SAAS;QACT,UAAU;QACV,WAAW,CAAC,oCAAoC,EAAE,WAAW;;YAE5D,wBAAU,+YAAC,gTAAO;gBAAC,WAAU;;;;;qCAA4B,+YAAC,iSAAK;gBAAC,WAAU;;;;;;YAC1E,UAAU,kBAAkB;;;;;;;AAGnC"}},
    {"offset": {"line": 219, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/services/audius.ts"],"sourcesContent":["import { AUDIUS_API_KEY, AUDIUS_API_BASE } from \"@/lib/constants\";\n\nconst BASE_URL = AUDIUS_API_BASE;\n\nexport interface AudiusUser {\n  id: string;\n  name: string;\n  handle: string;\n  profile_picture: {\n    \"150x150\": string;\n    \"480x480\": string;\n    \"1000x1000\": string;\n  } | null;\n  follower_count: number;\n}\n\nexport interface AudiusTrack {\n  id: string;\n  title: string;\n  artwork: {\n    \"150x150\": string;\n    \"480x480\": string;\n    \"1000x1000\": string;\n  };\n  description: string;\n  genre: string;\n  mood: string;\n  play_count: number;\n  favorite_count: number;\n  repost_count: number;\n  duration: number;\n  user: AudiusUser;\n}\n\nasync function audiusFetch<T>(endpoint: string, params?: Record<string, string>): Promise<T> {\n  const url = new URL(`${BASE_URL}${endpoint}`);\n\n  if (params) {\n    for (const [key, value] of Object.entries(params)) {\n      if (value !== undefined && value !== \"\") {\n        url.searchParams.set(key, value);\n      }\n    }\n  }\n\n  const response = await fetch(url.toString(), {\n    headers: {\n      Authorization: `Bearer ${AUDIUS_API_KEY}`,\n      Accept: \"application/json\",\n    },\n  });\n\n  if (!response.ok) {\n    throw new Error(\n      `Audius API error: ${response.status} ${response.statusText}`\n    );\n  }\n\n  const json = await response.json();\n  return json.data as T;\n}\n\nexport async function getTrack(trackId: string): Promise<AudiusTrack> {\n  return audiusFetch<AudiusTrack>(`/tracks/${trackId}`);\n}\n\nexport async function getTrendingTracks(\n  limit?: number,\n  genre?: string,\n  time?: \"week\" | \"month\" | \"allTime\"\n): Promise<AudiusTrack[]> {\n  const params: Record<string, string> = {};\n\n  if (limit !== undefined) {\n    params.limit = String(limit);\n  }\n  if (genre) {\n    params.genre = genre;\n  }\n  if (time) {\n    params.time = time;\n  }\n\n  return audiusFetch<AudiusTrack[]>(\"/tracks/trending\", params);\n}\n\nexport async function searchTracks(\n  query: string,\n  limit?: number\n): Promise<AudiusTrack[]> {\n  const params: Record<string, string> = { query };\n\n  if (limit !== undefined) {\n    params.limit = String(limit);\n  }\n\n  return audiusFetch<AudiusTrack[]>(\"/tracks/search\", params);\n}\n\nexport async function getUserTracks(userId: string): Promise<AudiusTrack[]> {\n  return audiusFetch<AudiusTrack[]>(`/users/${userId}/tracks`, { limit: \"100\" });\n}\n\n/** Get the direct stream URL for a track */\nexport function getTrackStreamUrl(trackId: string): string {\n  const url = new URL(`${BASE_URL}/tracks/${trackId}/stream`);\n  if (AUDIUS_API_KEY) {\n    url.searchParams.set(\"api_key\", AUDIUS_API_KEY);\n  }\n  return url.toString();\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAEA,MAAM,WAAW,0IAAe;AAgChC,eAAe,YAAe,QAAgB,EAAE,MAA+B;IAC7E,MAAM,MAAM,IAAI,IAAI,GAAG,WAAW,UAAU;IAE5C,IAAI,QAAQ;QACV,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,OAAO,OAAO,CAAC,QAAS;YACjD,IAAI,UAAU,aAAa,UAAU,IAAI;gBACvC,IAAI,YAAY,CAAC,GAAG,CAAC,KAAK;YAC5B;QACF;IACF;IAEA,MAAM,WAAW,MAAM,MAAM,IAAI,QAAQ,IAAI;QAC3C,SAAS;YACP,eAAe,CAAC,OAAO,EAAE,yIAAc,EAAE;YACzC,QAAQ;QACV;IACF;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MACR,CAAC,kBAAkB,EAAE,SAAS,MAAM,CAAC,CAAC,EAAE,SAAS,UAAU,EAAE;IAEjE;IAEA,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,OAAO,KAAK,IAAI;AAClB;AAEO,eAAe,SAAS,OAAe;IAC5C,OAAO,YAAyB,CAAC,QAAQ,EAAE,SAAS;AACtD;AAEO,eAAe,kBACpB,KAAc,EACd,KAAc,EACd,IAAmC;IAEnC,MAAM,SAAiC,CAAC;IAExC,IAAI,UAAU,WAAW;QACvB,OAAO,KAAK,GAAG,OAAO;IACxB;IACA,IAAI,OAAO;QACT,OAAO,KAAK,GAAG;IACjB;IACA,IAAI,MAAM;QACR,OAAO,IAAI,GAAG;IAChB;IAEA,OAAO,YAA2B,oBAAoB;AACxD;AAEO,eAAe,aACpB,KAAa,EACb,KAAc;IAEd,MAAM,SAAiC;QAAE;IAAM;IAE/C,IAAI,UAAU,WAAW;QACvB,OAAO,KAAK,GAAG,OAAO;IACxB;IAEA,OAAO,YAA2B,kBAAkB;AACtD;AAEO,eAAe,cAAc,MAAc;IAChD,OAAO,YAA2B,CAAC,OAAO,EAAE,OAAO,OAAO,CAAC,EAAE;QAAE,OAAO;IAAM;AAC9E;AAGO,SAAS,kBAAkB,OAAe;IAC/C,MAAM,MAAM,IAAI,IAAI,GAAG,SAAS,QAAQ,EAAE,QAAQ,OAAO,CAAC;IAC1D,IAAI,yIAAc,EAAE;QAClB,IAAI,YAAY,CAAC,GAAG,CAAC,WAAW,yIAAc;IAChD;IACA,OAAO,IAAI,QAAQ;AACrB"}},
    {"offset": {"line": 295, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/lib/idl.json"],"sourcesContent":["{\"address\":\"Atf26b8XuQ49cmvfTsvU5PjZ56zhoCvFiGQ7bBW2zoio\",\"metadata\":{\"name\":\"music_value\",\"version\":\"0.1.0\",\"spec\":\"0.1.0\",\"description\":\"MusicValue - Fans back music tracks and earn yield\"},\"instructions\":[{\"name\":\"deposit\",\"discriminator\":[242,35,198,137,82,225,242,182],\"accounts\":[{\"name\":\"user\",\"writable\":true,\"signer\":true},{\"name\":\"vault\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116]},{\"kind\":\"account\",\"path\":\"vault.audius_track_id\",\"account\":\"TrackVault\"}]}},{\"name\":\"user_position\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[112,111,115,105,116,105,111,110]},{\"kind\":\"account\",\"path\":\"vault\"},{\"kind\":\"account\",\"path\":\"user\"}]}},{\"name\":\"user_usdc\",\"writable\":true},{\"name\":\"vault_token_account\",\"writable\":true},{\"name\":\"share_mint\",\"writable\":true},{\"name\":\"user_shares\",\"writable\":true},{\"name\":\"token_program\",\"address\":\"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA\"},{\"name\":\"system_program\",\"address\":\"11111111111111111111111111111111\"}],\"args\":[{\"name\":\"amount\",\"type\":\"u64\"}]},{\"name\":\"distribute_yield\",\"discriminator\":[233,92,186,157,235,238,212,114],\"accounts\":[{\"name\":\"authority\",\"writable\":true,\"signer\":true},{\"name\":\"vault\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116]},{\"kind\":\"account\",\"path\":\"vault.audius_track_id\",\"account\":\"TrackVault\"}]}},{\"name\":\"authority_usdc\",\"writable\":true},{\"name\":\"vault_token_account\",\"writable\":true},{\"name\":\"token_program\",\"address\":\"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA\"}],\"args\":[{\"name\":\"amount\",\"type\":\"u64\"}]},{\"name\":\"initialize_vault\",\"discriminator\":[48,191,163,44,71,129,63,164],\"accounts\":[{\"name\":\"authority\",\"writable\":true,\"signer\":true},{\"name\":\"vault\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116]},{\"kind\":\"arg\",\"path\":\"audius_track_id\"}]}},{\"name\":\"usdc_mint\"},{\"name\":\"vault_token_account\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116,95,116,111,107,101,110]},{\"kind\":\"account\",\"path\":\"vault\"}]}},{\"name\":\"share_mint\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[115,104,97,114,101,95,109,105,110,116]},{\"kind\":\"account\",\"path\":\"vault\"}]}},{\"name\":\"token_program\",\"address\":\"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA\"},{\"name\":\"system_program\",\"address\":\"11111111111111111111111111111111\"},{\"name\":\"rent\",\"address\":\"SysvarRent111111111111111111111111111111111\"}],\"args\":[{\"name\":\"audius_track_id\",\"type\":\"string\"},{\"name\":\"cap\",\"type\":\"u64\"},{\"name\":\"royalty_pct\",\"type\":\"u8\"},{\"name\":\"distribution_interval\",\"type\":\"u8\"},{\"name\":\"vault_duration_months\",\"type\":\"u16\"},{\"name\":\"pledge_note\",\"type\":\"string\"}]},{\"name\":\"update_pledge\",\"discriminator\":[45,167,165,215,223,29,200,170],\"accounts\":[{\"name\":\"authority\",\"writable\":true,\"signer\":true},{\"name\":\"vault\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116]},{\"kind\":\"account\",\"path\":\"vault.audius_track_id\",\"account\":\"TrackVault\"}]}}],\"args\":[{\"name\":\"royalty_pct\",\"type\":\"u8\"},{\"name\":\"distribution_interval\",\"type\":\"u8\"},{\"name\":\"vault_duration_months\",\"type\":\"u16\"},{\"name\":\"pledge_note\",\"type\":\"string\"}]},{\"name\":\"withdraw\",\"discriminator\":[183,18,70,156,148,109,161,34],\"accounts\":[{\"name\":\"user\",\"writable\":true,\"signer\":true},{\"name\":\"vault\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[118,97,117,108,116]},{\"kind\":\"account\",\"path\":\"vault.audius_track_id\",\"account\":\"TrackVault\"}]}},{\"name\":\"user_position\",\"writable\":true,\"pda\":{\"seeds\":[{\"kind\":\"const\",\"value\":[112,111,115,105,116,105,111,110]},{\"kind\":\"account\",\"path\":\"vault\"},{\"kind\":\"account\",\"path\":\"user\"}]}},{\"name\":\"vault_token_account\",\"writable\":true},{\"name\":\"user_usdc\",\"writable\":true},{\"name\":\"share_mint\",\"writable\":true},{\"name\":\"user_shares\",\"writable\":true},{\"name\":\"token_program\",\"address\":\"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA\"}],\"args\":[{\"name\":\"shares\",\"type\":\"u64\"}]}],\"accounts\":[{\"name\":\"TrackVault\",\"discriminator\":[106,106,191,101,238,81,75,254]},{\"name\":\"UserPosition\",\"discriminator\":[251,248,209,245,83,234,17,27]}],\"errors\":[{\"code\":6000,\"name\":\"VaultCapExceeded\",\"msg\":\"Vault has reached its funding cap\"},{\"code\":6001,\"name\":\"ZeroDeposit\",\"msg\":\"Deposit amount must be greater than zero\"},{\"code\":6002,\"name\":\"InsufficientShares\",\"msg\":\"Insufficient shares to withdraw\"},{\"code\":6003,\"name\":\"ZeroWithdraw\",\"msg\":\"Withdraw amount must be greater than zero\"},{\"code\":6004,\"name\":\"TrackIdTooLong\",\"msg\":\"Audius track ID is too long (max 32 characters)\"},{\"code\":6005,\"name\":\"InvalidCap\",\"msg\":\"Vault cap must be greater than zero\"},{\"code\":6006,\"name\":\"Unauthorized\",\"msg\":\"Only the vault authority can perform this action\"},{\"code\":6007,\"name\":\"NoShareholders\",\"msg\":\"Cannot distribute yield when there are no shareholders\"},{\"code\":6008,\"name\":\"InvalidRoyaltyPct\",\"msg\":\"Royalty percentage must be between 0 and 100\"},{\"code\":6009,\"name\":\"InvalidDistributionInterval\",\"msg\":\"Distribution interval must be 0 (monthly), 1 (quarterly), or 2 (milestone)\"},{\"code\":6010,\"name\":\"PledgeNoteTooLong\",\"msg\":\"Pledge note is too long (max 200 characters)\"}],\"types\":[{\"name\":\"TrackVault\",\"type\":{\"kind\":\"struct\",\"fields\":[{\"name\":\"authority\",\"type\":\"pubkey\"},{\"name\":\"audius_track_id\",\"type\":\"string\"},{\"name\":\"usdc_mint\",\"type\":\"pubkey\"},{\"name\":\"vault_token_account\",\"type\":\"pubkey\"},{\"name\":\"share_mint\",\"type\":\"pubkey\"},{\"name\":\"total_deposited\",\"type\":\"u64\"},{\"name\":\"cap\",\"type\":\"u64\"},{\"name\":\"total_shares\",\"type\":\"u64\"},{\"name\":\"created_at\",\"type\":\"i64\"},{\"name\":\"bump\",\"type\":\"u8\"},{\"name\":\"royalty_pct\",\"type\":\"u8\"},{\"name\":\"distribution_interval\",\"type\":\"u8\"},{\"name\":\"vault_duration_months\",\"type\":\"u16\"},{\"name\":\"pledge_note\",\"type\":\"string\"},{\"name\":\"total_yield_distributed\",\"type\":\"u64\"}]}},{\"name\":\"UserPosition\",\"type\":{\"kind\":\"struct\",\"fields\":[{\"name\":\"owner\",\"type\":\"pubkey\"},{\"name\":\"vault\",\"type\":\"pubkey\"},{\"name\":\"shares_held\",\"type\":\"u64\"},{\"name\":\"total_deposited\",\"type\":\"u64\"},{\"name\":\"deposited_at\",\"type\":\"i64\"},{\"name\":\"bump\",\"type\":\"u8\"}]}}]}"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 295, "column": 6027}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 299, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/hooks/useVault.ts"],"sourcesContent":["\"use client\";\n\nimport { useMemo } from \"react\";\nimport { useConnection, useWallet } from \"@solana/wallet-adapter-react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { PublicKey, SystemProgram, SYSVAR_RENT_PUBKEY } from \"@solana/web3.js\";\nimport {\n  getAssociatedTokenAddress,\n  TOKEN_PROGRAM_ID,\n  createAssociatedTokenAccountInstruction,\n  getAccount,\n} from \"@solana/spl-token\";\nimport { Program, AnchorProvider, BN } from \"@coral-xyz/anchor\";\nimport { PROGRAM_ID_STR, USDC_MINT_STR } from \"@/lib/constants\";\nimport { getTrack, AudiusTrack } from \"@/services/audius\";\n\nimport idl from \"@/lib/idl.json\";\n\nfunction programId() {\n  return new PublicKey(PROGRAM_ID_STR);\n}\n\nfunction usdcMint() {\n  return new PublicKey(USDC_MINT_STR);\n}\n\nfunction useProgram() {\n  const { connection } = useConnection();\n  const wallet = useWallet();\n\n  return useMemo(() => {\n    if (!wallet.publicKey || !wallet.signTransaction) return null;\n\n    try {\n      const freshPublicKey = new PublicKey(wallet.publicKey.toBytes());\n\n      const wrappedWallet = {\n        publicKey: freshPublicKey,\n        signTransaction: wallet.signTransaction,\n        signAllTransactions: wallet.signAllTransactions,\n      };\n\n      const provider = new AnchorProvider(\n        connection,\n        wrappedWallet as any,\n        AnchorProvider.defaultOptions()\n      );\n\n      // Anchor 0.30+ new IDL format: Program constructor reads address from IDL\n      return new Program(idl as any, provider);\n    } catch (e) {\n      console.warn(\"Failed to initialize Anchor program:\", e);\n      return null;\n    }\n  }, [connection, wallet]);\n}\n\nfunction getVaultPda(trackId: string) {\n  return PublicKey.findProgramAddressSync(\n    [Buffer.from(\"vault\"), Buffer.from(trackId)],\n    programId()\n  );\n}\n\nfunction getVaultTokenPda(vaultPda: PublicKey) {\n  return PublicKey.findProgramAddressSync(\n    [Buffer.from(\"vault_token\"), vaultPda.toBuffer()],\n    programId()\n  );\n}\n\nfunction getShareMintPda(vaultPda: PublicKey) {\n  return PublicKey.findProgramAddressSync(\n    [Buffer.from(\"share_mint\"), vaultPda.toBuffer()],\n    programId()\n  );\n}\n\nfunction getUserPositionPda(vaultPda: PublicKey, user: PublicKey) {\n  return PublicKey.findProgramAddressSync(\n    [Buffer.from(\"position\"), vaultPda.toBuffer(), user.toBuffer()],\n    programId()\n  );\n}\n\n/** Fetch vault state for a track */\nexport function useVault(trackId: string | undefined) {\n  const program = useProgram();\n\n  return useQuery({\n    queryKey: [\"vault\", trackId],\n    queryFn: async () => {\n      if (!program || !trackId) return null;\n      const [vaultPda] = getVaultPda(trackId);\n      try {\n        const vault = await (program.account as any).trackVault.fetch(vaultPda);\n        return {\n          address: vaultPda,\n          audiusTrackId: vault.audiusTrackId as string,\n          totalDeposited: (vault.totalDeposited as BN).toNumber(),\n          cap: (vault.cap as BN).toNumber(),\n          totalShares: (vault.totalShares as BN).toNumber(),\n          authority: vault.authority as PublicKey,\n          shareMint: vault.shareMint as PublicKey,\n          royaltyPct: (vault.royaltyPct as number) ?? 0,\n          distributionInterval: (vault.distributionInterval as number) ?? 0,\n          vaultDurationMonths: (vault.vaultDurationMonths as number) ?? 0,\n          pledgeNote: (vault.pledgeNote as string) ?? \"\",\n          totalYieldDistributed: (vault.totalYieldDistributed as BN).toNumber(),\n        };\n      } catch {\n        return null;\n      }\n    },\n    enabled: !!program && !!trackId,\n  });\n}\n\n/** Fetch user's position in a vault */\nexport function useUserPosition(trackId: string | undefined) {\n  const program = useProgram();\n  const { publicKey } = useWallet();\n\n  return useQuery({\n    queryKey: [\"position\", trackId, publicKey?.toBase58()],\n    queryFn: async () => {\n      if (!program || !trackId || !publicKey) return null;\n      const [vaultPda] = getVaultPda(trackId);\n      const [positionPda] = getUserPositionPda(vaultPda, publicKey);\n      try {\n        const position = await (program.account as any).userPosition.fetch(\n          positionPda\n        );\n        return {\n          sharesHeld: (position.sharesHeld as BN).toNumber(),\n          totalDeposited: (position.totalDeposited as BN).toNumber(),\n          depositedAt: (position.depositedAt as BN).toNumber(),\n        };\n      } catch {\n        return null;\n      }\n    },\n    enabled: !!program && !!trackId && !!publicKey,\n  });\n}\n\nexport interface InitializeVaultParams {\n  cap: number;\n  royaltyPct: number;\n  distributionInterval: number; // 0=monthly, 1=quarterly, 2=milestone\n  vaultDurationMonths: number;  // 0 = ongoing\n  pledgeNote: string;\n}\n\n/** Initialize a vault for a track with a royalty pledge */\nexport function useInitializeVault(trackId: string) {\n  const program = useProgram();\n  const { publicKey } = useWallet();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (params: InitializeVaultParams) => {\n      if (!program || !publicKey) throw new Error(\"Wallet not connected\");\n\n      const mint = usdcMint();\n      const [vaultPda] = getVaultPda(trackId);\n      const [vaultTokenAccount] = getVaultTokenPda(vaultPda);\n      const [shareMint] = getShareMintPda(vaultPda);\n\n      const tx = await (program.methods as any)\n        .initializeVault(\n          trackId,\n          new BN(params.cap),\n          params.royaltyPct,\n          params.distributionInterval,\n          params.vaultDurationMonths,\n          params.pledgeNote\n        )\n        .accounts({\n          authority: publicKey,\n          vault: vaultPda,\n          usdcMint: mint,\n          vaultTokenAccount,\n          shareMint,\n          tokenProgram: TOKEN_PROGRAM_ID,\n          systemProgram: SystemProgram.programId,\n          rent: SYSVAR_RENT_PUBKEY,\n        })\n        .rpc();\n\n      return tx;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"vault\", trackId] });\n    },\n  });\n}\n\n/** Deposit USDC into a track vault */\nexport function useDeposit(trackId: string) {\n  const program = useProgram();\n  const { publicKey } = useWallet();\n  const { connection } = useConnection();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (amount: number) => {\n      if (!program || !publicKey) throw new Error(\"Wallet not connected\");\n\n      const mint = usdcMint();\n      const [vaultPda] = getVaultPda(trackId);\n      const [vaultTokenAccount] = getVaultTokenPda(vaultPda);\n      const [shareMint] = getShareMintPda(vaultPda);\n      const [userPosition] = getUserPositionPda(vaultPda, publicKey);\n\n      const userUsdc = await getAssociatedTokenAddress(mint, publicKey);\n      const userShares = await getAssociatedTokenAddress(shareMint, publicKey);\n\n      // Check if user share account exists, if not create it\n      let preIx: any[] = [];\n      try {\n        await getAccount(connection, userShares);\n      } catch {\n        preIx.push(\n          createAssociatedTokenAccountInstruction(\n            publicKey,\n            userShares,\n            publicKey,\n            shareMint\n          )\n        );\n      }\n\n      const builder = (program.methods as any)\n        .deposit(new BN(amount))\n        .accounts({\n          user: publicKey,\n          vault: vaultPda,\n          userPosition,\n          userUsdc,\n          vaultTokenAccount,\n          shareMint,\n          userShares,\n          tokenProgram: TOKEN_PROGRAM_ID,\n          systemProgram: SystemProgram.programId,\n        });\n\n      if (preIx.length > 0) {\n        builder.preInstructions(preIx);\n      }\n\n      return await builder.rpc();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"vault\", trackId] });\n      queryClient.invalidateQueries({ queryKey: [\"position\", trackId] });\n    },\n  });\n}\n\n/** Distribute yield into the vault (artist/authority only) */\nexport function useDistributeYield(trackId: string) {\n  const program = useProgram();\n  const { publicKey } = useWallet();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (amountUsdc: number) => {\n      if (!program || !publicKey) throw new Error(\"Wallet not connected\");\n\n      const mint = usdcMint();\n      const [vaultPda] = getVaultPda(trackId);\n      const [vaultTokenAccount] = getVaultTokenPda(vaultPda);\n      const authorityUsdc = await getAssociatedTokenAddress(mint, publicKey);\n\n      const tx = await (program.methods as any)\n        .distributeYield(new BN(amountUsdc))\n        .accounts({\n          authority: publicKey,\n          vault: vaultPda,\n          authorityUsdc,\n          vaultTokenAccount,\n          tokenProgram: TOKEN_PROGRAM_ID,\n        })\n        .rpc();\n\n      return tx;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"vault\", trackId] });\n    },\n  });\n}\n\n/** Read-only program (no wallet needed — for fetching all vault accounts on the homepage) */\nfunction useReadonlyProgram() {\n  const { connection } = useConnection();\n  return useMemo(() => {\n    try {\n      const dummy = {\n        publicKey: new PublicKey(\"11111111111111111111111111111111\"),\n        signTransaction: async (tx: any) => tx,\n        signAllTransactions: async (txs: any[]) => txs,\n      };\n      const provider = new AnchorProvider(connection, dummy as any, AnchorProvider.defaultOptions());\n      return new Program(idl as any, provider);\n    } catch {\n      return null;\n    }\n  }, [connection]);\n}\n\nexport interface VaultInfo {\n  address: PublicKey;\n  audiusTrackId: string;\n  totalDeposited: number;\n  cap: number;\n  totalShares: number;\n  authority: PublicKey;\n  shareMint: PublicKey;\n  // Royalty pledge fields\n  royaltyPct: number;\n  distributionInterval: number; // 0=monthly, 1=quarterly, 2=milestone\n  vaultDurationMonths: number;  // 0 = ongoing\n  pledgeNote: string;\n  totalYieldDistributed: number;\n}\n\nexport interface VaultedTrack {\n  vault: VaultInfo;\n  track: AudiusTrack;\n}\n\n/** Fetch every TrackVault account on-chain (works without a connected wallet) */\nexport function useAllVaults() {\n  const program = useReadonlyProgram();\n\n  return useQuery({\n    queryKey: [\"all-vaults\"],\n    queryFn: async (): Promise<VaultInfo[]> => {\n      if (!program) return [];\n      const accounts = await (program.account as any).trackVault.all();\n      return accounts.map((a: any) => ({\n        address: a.publicKey as PublicKey,\n        audiusTrackId: a.account.audiusTrackId as string,\n        totalDeposited: (a.account.totalDeposited as BN).toNumber(),\n        cap: (a.account.cap as BN).toNumber(),\n        totalShares: (a.account.totalShares as BN).toNumber(),\n        authority: a.account.authority as PublicKey,\n        shareMint: a.account.shareMint as PublicKey,\n        royaltyPct: (a.account.royaltyPct as number) ?? 0,\n        distributionInterval: (a.account.distributionInterval as number) ?? 0,\n        vaultDurationMonths: (a.account.vaultDurationMonths as number) ?? 0,\n        pledgeNote: (a.account.pledgeNote as string) ?? \"\",\n        totalYieldDistributed: (a.account.totalYieldDistributed as BN).toNumber(),\n      }));\n    },\n    enabled: !!program,\n    staleTime: 30_000,\n  });\n}\n\n/** Fetch all vaults and hydrate each with Audius track metadata */\nexport function useVaultedTracks() {\n  const { data: vaults } = useAllVaults();\n\n  return useQuery({\n    queryKey: [\"vaulted-tracks\", vaults?.map((v) => v.audiusTrackId).join(\",\")],\n    queryFn: async (): Promise<VaultedTrack[]> => {\n      if (!vaults || vaults.length === 0) return [];\n      const results = await Promise.allSettled(vaults.map((v) => getTrack(v.audiusTrackId)));\n      return vaults\n        .map((vault, i) => {\n          const r = results[i];\n          return r.status === \"fulfilled\" ? { vault, track: r.value } : null;\n        })\n        .filter(Boolean) as VaultedTrack[];\n    },\n    enabled: Array.isArray(vaults),\n    staleTime: 60_000,\n  });\n}\n\n/** Withdraw from a track vault */\nexport function useWithdraw(trackId: string) {\n  const program = useProgram();\n  const { publicKey } = useWallet();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (shares: number) => {\n      if (!program || !publicKey) throw new Error(\"Wallet not connected\");\n\n      const mint = usdcMint();\n      const [vaultPda] = getVaultPda(trackId);\n      const [vaultTokenAccount] = getVaultTokenPda(vaultPda);\n      const [shareMint] = getShareMintPda(vaultPda);\n      const [userPosition] = getUserPositionPda(vaultPda, publicKey);\n\n      const userUsdc = await getAssociatedTokenAddress(mint, publicKey);\n      const userShares = await getAssociatedTokenAddress(shareMint, publicKey);\n\n      const tx = await (program.methods as any)\n        .withdraw(new BN(shares))\n        .accounts({\n          user: publicKey,\n          vault: vaultPda,\n          userPosition,\n          vaultTokenAccount,\n          userUsdc,\n          shareMint,\n          userShares,\n          tokenProgram: TOKEN_PROGRAM_ID,\n        })\n        .rpc();\n\n      return tx;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"vault\", trackId] });\n      queryClient.invalidateQueries({ queryKey: [\"position\", trackId] });\n    },\n  });\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 691, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/components/artist/ArtistVaultCard.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { AudiusTrack } from \"@/services/audius\";\nimport { useVault, useDistributeYield } from \"@/hooks/useVault\";\nimport { Loader2, TrendingUp, Users, Zap, X, Lock, ArrowRight } from \"lucide-react\";\nimport { USDC_DECIMALS } from \"@/lib/constants\";\nimport toast from \"react-hot-toast\";\n\ninterface ArtistVaultCardProps {\n  track: AudiusTrack;\n}\n\nfunction formatUSDC(amount: number): string {\n  return `$${(amount / 10 ** USDC_DECIMALS).toLocaleString(\"en-US\", {\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  })}`;\n}\n\nexport function ArtistVaultCard({ track }: ArtistVaultCardProps) {\n  const { data: vault, isLoading } = useVault(track.id);\n  const distributeYield = useDistributeYield(track.id);\n  const [showModal, setShowModal] = useState(false);\n  const [distributeAmount, setDistributeAmount] = useState(\"\");\n\n  const progress = vault ? Math.min((vault.totalDeposited / vault.cap) * 100, 100) : 0;\n  const isCapReached = progress >= 100;\n\n  // Total yield already distributed = total_deposited - total_shares (since deposits are 1:1)\n  const totalYieldDistributed = vault\n    ? Math.max(0, vault.totalDeposited - vault.totalShares)\n    : 0;\n\n  const sharePrice =\n    vault && vault.totalShares > 0\n      ? vault.totalDeposited / vault.totalShares\n      : 1;\n\n  // Preview: what share price will be after this distribution\n  const previewAmount = parseFloat(distributeAmount) || 0;\n  const previewLamports = Math.floor(previewAmount * 10 ** USDC_DECIMALS);\n  const previewSharePrice =\n    vault && vault.totalShares > 0 && previewLamports > 0\n      ? (vault.totalDeposited + previewLamports) / vault.totalShares\n      : null;\n\n  const handleDistribute = async () => {\n    if (!previewAmount || previewAmount <= 0) {\n      toast.error(\"Enter a valid amount to distribute\");\n      return;\n    }\n    try {\n      await distributeYield.mutateAsync(previewLamports);\n      setShowModal(false);\n      setDistributeAmount(\"\");\n      toast.success(`Distributed ${formatUSDC(previewLamports)} to all backers!`);\n    } catch (err: any) {\n      toast.error(err.message || \"Distribution failed\");\n    }\n  };\n\n  return (\n    <>\n      <div className=\"glass-card p-5\">\n        {/* Track header */}\n        <div className=\"flex items-start gap-4\">\n          <img\n            src={track.artwork?.[\"150x150\"] || \"/placeholder-track.svg\"}\n            alt={track.title}\n            className=\"h-14 w-14 rounded-xl object-cover flex-shrink-0\"\n            onError={(e) => { (e.target as HTMLImageElement).src = \"/placeholder-track.svg\"; }}\n          />\n          <div className=\"min-w-0 flex-1\">\n            <h3 className=\"truncate font-semibold text-white\">{track.title}</h3>\n            <div className=\"mt-1 flex items-center gap-3 text-xs text-slate-400\">\n              <span className=\"flex items-center gap-1\">\n                <Users className=\"h-3 w-3\" />\n                {track.play_count.toLocaleString()} plays\n              </span>\n              {track.genre && (\n                <span className=\"rounded bg-accent-purple/15 px-1.5 py-0.5 text-[10px] font-medium text-accent-purple\">\n                  {track.genre}\n                </span>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Vault info */}\n        {isLoading ? (\n          <div className=\"mt-4 flex justify-center py-4\">\n            <Loader2 className=\"h-5 w-5 animate-spin text-slate-500\" />\n          </div>\n        ) : vault ? (\n          <div className=\"mt-4 space-y-3\">\n            {/* Stats grid */}\n            <div className=\"grid grid-cols-2 gap-2\">\n              <div className=\"rounded-lg bg-base-50 p-2.5 text-center\">\n                <p className=\"text-[10px] text-slate-500\">Raised</p>\n                <p className=\"mt-0.5 text-sm font-bold text-white\">\n                  {formatUSDC(vault.totalDeposited)}\n                </p>\n              </div>\n              <div className=\"rounded-lg bg-base-50 p-2.5 text-center\">\n                <p className=\"text-[10px] text-slate-500\">Cap</p>\n                <p className=\"mt-0.5 text-sm font-bold text-white\">\n                  {formatUSDC(vault.cap)}\n                </p>\n              </div>\n              <div className=\"rounded-lg bg-base-50 p-2.5 text-center\">\n                <p className=\"text-[10px] text-slate-500\">Share Price</p>\n                <p className=\"mt-0.5 text-sm font-bold text-accent-cyan\">\n                  ${(sharePrice).toFixed(4)}\n                </p>\n              </div>\n              <div className=\"rounded-lg bg-base-50 p-2.5 text-center\">\n                <p className=\"text-[10px] text-slate-500\">Yield Sent</p>\n                <p className=\"mt-0.5 text-sm font-bold text-accent-cyan\">\n                  {formatUSDC(totalYieldDistributed)}\n                </p>\n              </div>\n            </div>\n\n            {/* Progress bar */}\n            <div>\n              <div className=\"mb-1 flex justify-between text-[10px] text-slate-500\">\n                <span className={isCapReached ? \"text-yellow-400 font-medium\" : \"\"}>\n                  {isCapReached ? \"Vault Full\" : `${progress.toFixed(1)}% funded`}\n                </span>\n                <span>{(vault.totalShares / 10 ** USDC_DECIMALS).toFixed(0)} shares minted</span>\n              </div>\n              <div className=\"vault-progress h-1.5\">\n                <div\n                  className={`vault-progress-bar ${isCapReached ? \"!bg-yellow-400\" : \"\"}`}\n                  style={{ width: `${progress}%` }}\n                />\n              </div>\n            </div>\n\n            {/* Vault full notice */}\n            {isCapReached && (\n              <div className=\"flex items-center gap-2 rounded-lg border border-yellow-500/20 bg-yellow-500/5 px-3 py-2\">\n                <Lock className=\"h-3.5 w-3.5 text-yellow-400 flex-shrink-0\" />\n                <p className=\"text-[11px] text-yellow-400\">\n                  Vault is full — closed to new backers. You can still distribute yield.\n                </p>\n              </div>\n            )}\n\n            {/* Distribute yield button */}\n            <button\n              onClick={() => setShowModal(true)}\n              className=\"flex w-full items-center justify-center gap-2 rounded-xl border border-accent-cyan/30 bg-accent-cyan/10 py-2.5 text-sm font-medium text-accent-cyan transition-colors hover:bg-accent-cyan/20\"\n            >\n              <Zap className=\"h-4 w-4\" />\n              Distribute Royalties\n            </button>\n          </div>\n        ) : (\n          <div className=\"mt-4 rounded-lg border border-yellow-500/20 bg-yellow-500/5 p-3 text-center\">\n            <p className=\"text-xs text-yellow-400\">No vault created for this track yet</p>\n          </div>\n        )}\n      </div>\n\n      {/* Distribute yield modal */}\n      {showModal && vault && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4 backdrop-blur-sm\">\n          <div className=\"glass-card w-full max-w-sm p-6\">\n            <div className=\"flex items-center justify-between\">\n              <h3 className=\"text-lg font-bold text-white\">Distribute Royalties</h3>\n              <button\n                onClick={() => { setShowModal(false); setDistributeAmount(\"\"); }}\n                className=\"text-slate-400 transition-colors hover:text-white\"\n              >\n                <X className=\"h-5 w-5\" />\n              </button>\n            </div>\n\n            <p className=\"mt-2 text-sm text-slate-400\">\n              Send USDC from your wallet into the vault. Every backer's share\n              automatically increases in value — proportional to their holdings.\n            </p>\n\n            {/* Current state */}\n            <div className=\"mt-4 grid grid-cols-2 gap-2\">\n              <div className=\"rounded-lg bg-base-50 p-3 text-center\">\n                <p className=\"text-[10px] text-slate-500\">Current share price</p>\n                <p className=\"mt-1 text-lg font-bold text-white\">\n                  ${(sharePrice).toFixed(4)}\n                </p>\n              </div>\n              <div className=\"rounded-lg bg-base-50 p-3 text-center\">\n                <p className=\"text-[10px] text-slate-500\">Yield sent so far</p>\n                <p className=\"mt-1 text-lg font-bold text-accent-cyan\">\n                  {formatUSDC(totalYieldDistributed)}\n                </p>\n              </div>\n            </div>\n\n            {/* Amount input */}\n            <div className=\"mt-4\">\n              <label className=\"mb-1.5 block text-xs font-medium text-slate-400\">\n                Amount to distribute (USDC from your wallet)\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"number\"\n                  value={distributeAmount}\n                  onChange={(e) => setDistributeAmount(e.target.value)}\n                  placeholder=\"0.00\"\n                  min=\"0\"\n                  step=\"0.01\"\n                  className=\"h-12 w-full rounded-xl border border-base-200 bg-base-50 pl-4 pr-16 text-lg text-white outline-none transition-colors focus:border-accent-cyan/50\"\n                />\n                <span className=\"absolute right-4 top-1/2 -translate-y-1/2 text-sm font-medium text-slate-400\">\n                  USDC\n                </span>\n              </div>\n              <div className=\"mt-2 flex gap-2\">\n                {[50, 100, 250, 500].map((amt) => (\n                  <button\n                    key={amt}\n                    onClick={() => setDistributeAmount(amt.toString())}\n                    className=\"flex-1 rounded-lg border border-base-200 py-1 text-xs text-slate-400 transition-colors hover:border-accent-cyan/30 hover:text-accent-cyan\"\n                  >\n                    ${amt}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Share price preview */}\n            {previewSharePrice !== null && (\n              <div className=\"mt-4 flex items-center gap-3 rounded-xl border border-accent-cyan/20 bg-accent-cyan/5 p-3\">\n                <div className=\"text-center flex-1\">\n                  <p className=\"text-[10px] text-slate-500\">Current price</p>\n                  <p className=\"text-sm font-bold text-white\">${sharePrice.toFixed(4)}</p>\n                </div>\n                <ArrowRight className=\"h-4 w-4 text-accent-cyan flex-shrink-0\" />\n                <div className=\"text-center flex-1\">\n                  <p className=\"text-[10px] text-slate-500\">After distribution</p>\n                  <p className=\"text-sm font-bold text-accent-cyan\">\n                    ${previewSharePrice.toFixed(4)}\n                  </p>\n                </div>\n              </div>\n            )}\n\n            <div className=\"mt-5 flex gap-3\">\n              <button\n                onClick={() => { setShowModal(false); setDistributeAmount(\"\"); }}\n                className=\"flex-1 rounded-xl border border-base-200 py-2.5 text-sm text-slate-400 transition-colors hover:text-white\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleDistribute}\n                disabled={distributeYield.isPending || !previewAmount || previewAmount <= 0}\n                className=\"btn-primary flex flex-1 items-center justify-center gap-2 py-2.5 text-sm\"\n              >\n                {distributeYield.isPending ? (\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  <Zap className=\"h-4 w-4\" />\n                )}\n                {distributeYield.isPending ? \"Distributing...\" : \"Confirm\"}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1390, "column": 0}, "map": {"version":3,"sources":["file:///D:/MusicValue/app/src/app/artist/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useWallet } from \"@solana/wallet-adapter-react\";\nimport { useAudiusAuth } from \"@/hooks/useAudiusAuth\";\nimport { AudiusLoginButton } from \"@/components/artist/AudiusLoginButton\";\nimport { ArtistVaultCard } from \"@/components/artist/ArtistVaultCard\";\nimport { WalletButton } from \"@/components/wallet/WalletButton\";\nimport { getUserTracks } from \"@/services/audius\";\nimport { AudiusTrack } from \"@/services/audius\";\nimport { Music, Plus, Loader2 } from \"lucide-react\";\nimport Link from \"next/link\";\n\nfunction ArtistDashboard() {\n  const { user: audiusUser } = useAudiusAuth();\n  const { publicKey } = useWallet();\n  const [tracks, setTracks] = useState<AudiusTrack[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // Fetch tracks once; vault data is fetched per-card (no hooks in loop)\n  useEffect(() => {\n    if (!audiusUser) {\n      setIsLoading(false);\n      return;\n    }\n    getUserTracks(audiusUser.userId)\n      .then(setTracks)\n      .catch(() => setTracks([]))\n      .finally(() => setIsLoading(false));\n  }, [audiusUser]);\n\n  return (\n    <div className=\"mx-auto max-w-5xl px-4 py-10 sm:px-6\">\n      {/* Header */}\n      <div className=\"flex items-start justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-extrabold text-white\">Artist Dashboard</h1>\n          <p className=\"mt-1 text-sm text-slate-400\">\n            Manage your music vaults and distribute yield to fans\n          </p>\n        </div>\n        <Link\n          href=\"/artist/register\"\n          className=\"btn-primary flex items-center gap-2 text-sm\"\n        >\n          <Plus className=\"h-4 w-4\" />\n          New Vault\n        </Link>\n      </div>\n\n      {/* Auth status cards */}\n      <div className=\"mt-6 grid gap-4 sm:grid-cols-2\">\n        <div className=\"glass-card p-4\">\n          <p className=\"mb-2 text-xs font-medium uppercase tracking-wider text-slate-500\">\n            Audius Account\n          </p>\n          <AudiusLoginButton />\n        </div>\n        <div className=\"glass-card p-4\">\n          <p className=\"mb-2 text-xs font-medium uppercase tracking-wider text-slate-500\">\n            Solana Wallet\n          </p>\n          <WalletButton />\n          {publicKey && (\n            <p className=\"mt-1.5 text-xs text-slate-500\">\n              {publicKey.toBase58().slice(0, 8)}…{publicKey.toBase58().slice(-8)}\n            </p>\n          )}\n        </div>\n      </div>\n\n      {/* Tracks & vaults */}\n      <div className=\"mt-8\">\n        <h2 className=\"mb-4 text-lg font-bold text-white\">Your Tracks</h2>\n        {isLoading ? (\n          <div className=\"flex justify-center py-12\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-accent-purple\" />\n          </div>\n        ) : tracks.length === 0 ? (\n          <div className=\"glass-card p-8 text-center\">\n            <Music className=\"mx-auto mb-3 h-10 w-10 text-slate-600\" />\n            <p className=\"text-slate-400\">\n              No tracks found. Make sure your Audius account is connected.\n            </p>\n            <Link\n              href=\"/artist/register\"\n              className=\"btn-primary mt-4 inline-flex items-center gap-2 text-sm\"\n            >\n              <Plus className=\"h-4 w-4\" />\n              Create Your First Vault\n            </Link>\n          </div>\n        ) : (\n          <div className=\"grid gap-4 sm:grid-cols-2\">\n            {tracks.map((track) => (\n              <ArtistVaultCard key={track.id} track={track} />\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default function ArtistPage() {\n  const { user: audiusUser, isLoading } = useAudiusAuth();\n  const { publicKey } = useWallet();\n\n  if (isLoading) {\n    return (\n      <div className=\"flex min-h-[60vh] items-center justify-center\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-accent-purple\" />\n      </div>\n    );\n  }\n\n  // Dual auth gate: need both Audius connected AND Solana wallet\n  if (!audiusUser || !publicKey) {\n    return (\n      <div className=\"mx-auto max-w-lg px-4 py-20 text-center sm:px-6\">\n        <div className=\"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-primary\">\n          <Music className=\"h-8 w-8 text-white\" />\n        </div>\n        <h1 className=\"text-2xl font-extrabold text-white\">Artist Portal</h1>\n        <p className=\"mt-3 text-slate-400\">\n          Connect both your Audius account and Solana wallet to access your\n          artist dashboard.\n        </p>\n\n        <div className=\"mt-8 space-y-4\">\n          <div className=\"glass-card p-4 text-left\">\n            <p className=\"mb-2 text-xs font-medium uppercase tracking-wider text-slate-500\">\n              Step 1 — Audius Identity\n            </p>\n            <AudiusLoginButton className=\"w-full justify-center\" />\n          </div>\n          <div className=\"glass-card p-4 text-left\">\n            <p className=\"mb-2 text-xs font-medium uppercase tracking-wider text-slate-500\">\n              Step 2 — Solana Wallet\n            </p>\n            <WalletButton />\n          </div>\n        </div>\n\n        <Link\n          href=\"/artist/register\"\n          className=\"mt-6 inline-flex items-center gap-1.5 text-sm text-accent-purple hover:underline\"\n        >\n          New to MusicValue? Register as an artist\n        </Link>\n      </div>\n    );\n  }\n\n  return <ArtistDashboard />;\n}\n"],"names":[],"mappings":"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"}}]
}